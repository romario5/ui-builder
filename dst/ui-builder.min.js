(function(){"use strict";function splitByUpperCase(e){return e.replace(/([A-Z]+)/g,",$1").replace(/^,/,"").split(",")}function makeClassName(e){return splitByUpperCase(e.replace(/\//g,"_").replace(" - ","-")).join("-").replace(/([a-zA-Z_-])\s+([a-zA-Z_\-\d])/g,"$1-$2").replace(/\s*-+\s*/gi,"-").replace(/-*_-*/gi,"_").toLowerCase()}function Exception(e){this.message=e}function UIRegistrationException$1(e){Exception.call(this,e),this.name="UI registration."}function InvalidSchemeException(e){Exception.call(this,e),this.name="Invalid scheme."}function RenderingException(e){Exception.call(this,e),this.name="Rendering error."}function log(){let e=Array.prototype.slice.call(arguments);Settings.logging&&console.log.apply(console,msgFormatter(e))}function warn(){let e=Array.prototype.slice.call(arguments);Settings.logging&&console.warn.apply(console,msgFormatter(e))}function error(e){if(Settings.logging){let t=Array.prototype.slice.call(arguments);e instanceof Exception?e.log():console.error.apply(console,msgFormatter(t))}}function defaultFormatter(e){return e.unshift("UI >"),e}function chromeFormatter(e){return e.unshift("font-weight: 900"),e.unshift("%c UI >"),e}function addEventsMethods(e){e.hasOwnProperty("__")||(e.__={}),e.__.events={},e.__.dispatchers={},e.__.eventsTimeouts={},e.listen=function(e,t){let n=null,r=e.split("->");return 2===r.length&&(e=r[0].trim(),n=r[1].trim()),e=e.toLowerCase(),this.__.dispatchers.hasOwnProperty(e)||(this.__.dispatchers[e]=new EventsDispatcher(e)),null!==n&&"function"==typeof t&&this.__.dispatchers[e].on(n,t),this.__.dispatchers[e]},e.addEventListener=function(e,t){let n=null,r=e.split("->");if(2===r.length&&(e=r[0].trim(),n=r[1].trim()),e=e.toLowerCase(),"function"!=typeof t)throw new EventException("Type of handler is not a function");if(null!==n)this.listen(e).onPort(n,t);else{if(Array.isArray(this.__.events[e])||(this.__.events[e]=[]),0<=this.__.events[e].indexOf(t))return;this.__.events[e].push(t)}return this},e.on=e.addEventListener,e.removeEventListener=function(e,t){if(e=e.toLowerCase(),!this.__.events.hasOwnProperty(e))return this;if(void 0===t)delete this.__.events[e],this.__.events[e]=[];else{if("function"!=typeof t)throw new EventException("Type of handler is not a function");let n=this.__.events[e].indexOf(t);if(0>n)return this;this.__.events[e].splice(n,1)}return this},e.off=e.removeEventListener,e.triggerEvent=function(e){e=e.toLowerCase();let t=0,n=e.split("~");1<n.length&&(t=parseInt(n[1].trim())),e=n[0].trim();let r=[];for(let t=1,n=arguments.length;t<n;t++)r.push(arguments[t]);if(void 0!==this.__.eventsTimeouts&&clearTimeout(this.__.eventsTimeouts[e]),this.__.dispatchers.hasOwnProperty(e)&&(0<t?this.__.eventsTimeouts[e]=setTimeout(function(e,t,n){e.__.dispatchers[t].runHandlers(e,n)},t,this,e,r):this.__.dispatchers[e].runHandlers(this,r)),!!this.__.events.hasOwnProperty(e))if(0<t)this.__.eventsTimeouts[e]=setTimeout(function(e,t,n){for(let r=0;r<e.__.events[t].length;r++)e.__.events[t][r].apply(e,n)},t,this,e,r);else for(let t=0;t<this.__.events[e].length;t++)this.__.events[e][t].apply(this,r)},e.interruptEvent=function(e){return clearTimeout(this.__.eventsTimeouts[e]),this},e.offPort=function(e,t){if(t===void 0){let n=e.split("->");2===n.length&&(e=n[0].trim(),t=n[1].trim())}e=e.toLowerCase(),this.__.dispatchers.hasOwnProperty(e)&&this.__.dispatchers[e].offPort(t)},e.offAllPorts=function(e){e=e.toLowerCase(),this.__.dispatchers.hasOwnProperty(e)&&this.__.dispatchers[e].offAllPorts()},e.trigger=e.triggerEvent}function cloneSimpleObject(e){let t={};for(let n in e)e.hasOwnProperty(n)&&(t[n]=Array.isArray(e[n])?e[n].slice(0):null!==e[n]&&"object"==typeof e[n]&&e[n].constructor===Object&&null!==e[n]?cloneSimpleObject(e[n]):e[n]);return t}function cloneObjectTo(e,t){for(let n in e)e.hasOwnProperty(n)&&(Array.isArray(e[n])?t[n]=e[n].slice(0):"object"==typeof e[n]?(t[n]={},cloneObjectTo(e[n],t[n])):t[n]=e[n])}function extendObject(e,t){for(let n in e)e.hasOwnProperty(n)&&("object"!=typeof e[n]||e[n].constructor!==Object?t[n]=e[n]:("object"!=typeof t[n]&&(t[n]={}),extendObject(e[n],t[n])));return t}function extensionsManager(e){return extensions.hasOwnProperty(e)?extensions[e]:null}function defaultCollector(e){"function"!=typeof e&&this.triggerEvent("error"),e(this.cache,this),this.triggerEvent("dataReady",this.cache)}function runElementHandlers(t){let e=this.uielement.__.events[t.type];for(let n=0;n<e.length;n++)e[n].call(this.uielement,this.uiinstance,t)}function createValueHolder(){function e(){}let t;return e.prototype.value=function(e){return void 0!==e&&(t=e),t},e.prototype.isEmpty=function(){for(let e in this)if(this.hasOwnProperty(e)&&(null===this[e]||void 0===this[e]||""===this[e]))return!1;return!0},new e}function gatherElementData(e,t,n,r,o){"object"!=typeof n&&(n=t);let s=null,d;if(e.hasAttr("name")&&""!==e.attr("name")){s=e.attr("name");let n=new Event("gather");if(e.triggerEvent("gather",t,n),0<=["INPUT","TEXTAREA","SELECT"].indexOf(e.tagName()))return"checkbox"!==e.attr("type")||e.prop("checked")?(t.value(e.val()),t):t}if("string"!=typeof r&&(r=s),e.hasInclusion()){let o=createValueHolder();if(gatherInstanceData(e.inclusion(),o,null,n,r),(0<Object.keys(o).length||"function"==typeof o.value&&void 0!==o.value())&&!t.hasOwnProperty(r))if(null===s)for(let e in o)o.hasOwnProperty(e)&&(t[e]=o[e]);else if(void 0!==o.value())t.value(o.value());else if(0<Object.keys(o).length)for(let e in o)o.hasOwnProperty(e)&&(t[e]=o[e])}else if(e.hasChildUI()){let o=[];if(null!==s||null!==r){d=e.children();for(let e=0,t;e<d.length;e++)if(t=createValueHolder(),gatherInstanceData(d[e],t,null,n,r),"function"==typeof t.value&&void 0!==t.value())o.push(t.value());else if(0<Object.keys(t).length){let e={};for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.push(e)}t.value(o)}}else if(0<e.children().length){d=e.children();for(let e=0;e<d.length;e++)if(void 0!==d[e].getRootElement){let o=d[e].getRootElement();o.hasAttr("name")&&(s=o.attr("name"));let l=createValueHolder();if(gatherInstanceData(d[e],l,null,n,r),null===s)for(let e in l)l.hasOwnProperty(e)&&(t[e]=l[e]);else if("function"==typeof l.value&&void 0!==l.value())t[s]=l.value();else if(0<Object.keys(l).length){let e={};for(let t in l)l.hasOwnProperty(t)&&(e[t]=l[t]);t[s]=e}}}else if(!0===o){let r=e.__.node.childNodes;for(let e=0;e<r.length;e++){if(void 0===r[e]||void 0===r[e].element)continue;let o=r[e].element.attr("name"),s=createValueHolder();if(gatherElementData(r[e].uielement,s,n,""===o?null:o,!0),"string"!=typeof o||""===o)for(let e in s)s.hasOwnProperty(e)&&(t[e]=s[e]);else if("function"==typeof s.value&&void 0!==s.value())t[o]=s.value();else if(0<Object.keys(s).length){let e={};for(let t in s)s.hasOwnProperty(t)&&(e[t]=s[t]);t[o]=e}}}}function gatherInstanceData(e,t,n,r,o){(void 0===n||null===n)&&(n=e.__.ui.scheme),void 0===t&&(t={});let s=new Event("gather",{cancelable:!0});if(e.triggerEvent("gather",t,s),s.defaultPrevented)return;if(e.ui().triggerEvent("gather",e,t,s),s.defaultPrevented)return;let d,l;for(let c in n){if(!n.hasOwnProperty(c)||!e.hasOwnProperty(c))continue;gatherElementData(e[c],d=createValueHolder(),r,o);let p=e[c].attr("name");if("function"==typeof d.value&&void 0!==d.value()&&""!==p)addGatheredData(t,p,d.value());else{for(let e in l=Object.keys(d),d)d.hasOwnProperty(e)&&addGatheredData(t,e,d[e]);d="object"==typeof d[l[0]]?d[l[0]]:t}let u=n[c];"object"==typeof u&&gatherInstanceData(e,d,u,r,o)}}function addGatheredData(e,t,n){Array.isArray(e)?e.push(n):e.hasOwnProperty(t)?(!Array.isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n}function compactData(e){for(let t in e)if(e.hasOwnProperty(t))if(Array.isArray(e[t])){let n=[];for(let r=0;r<e[t].length;r++)if("object"==typeof e[t][r]){let o=Object.keys(e[t][r]);if(1===o.length)n.push(e[t][r][o[0]]);else return}else return;e[t]=n}else"object"==typeof e[t]&&compactData(e[t])}function tabClickHandler(){if(!this.isTab())return;let e=this.getAllNearbyElements();for(let t=0,n=e.length;t<n;t++)e[t].isTab()&&(e[t].removeClass("active"),e[t].__.tabContainer.fadeOut(100,function(){this.hide()}));this.addClass("active");let t=this.__.tabContainer;setTimeout(function(){t.fadeIn(100,"flex")},100),t.addClass("active")}function cloneSchemeLinear(e,t){for(let n in e)if(e.hasOwnProperty(n))if("object"==typeof e[n])cloneSchemeLinear(e[n],t),t[n]={name:n,rules:"",children:e[n]};else if("string"==typeof e[n])t[n]={name:n,rules:e[n],children:null};else if(!1===e[n])delete e[n];else throw new InvalidSchemeException("Value of the element must be string or object.")}function parseParameters(e){let t={parameters:{}},n=e.match(Settings.regexp_params);e=e.replace(Settings.regexp_params,""),n=null!==n&&0<n.length?n[0].slice(1,-1):"",n=n.split(";");for(let r=0,o;r<n.length;r++)if(o=n[r].split("="),2===o.length){if(""===o[0].trim())continue;t.parameters[o[0].trim()]=o[1].trim()}t.attributes={};let r=e.match(Settings.regexp_attribute);e=e.replace(Settings.regexp_attribute,""),r=null!==r&&0<r.length?r[0].slice(1,-1):"",r=r.split(";");let o;for(let n=0;n<r.length;n++)if(o=r[n].split("="),2===o.length){if(""===o[0].trim())continue;t.attributes[o[0].trim()]=o[1].trim()}t.properties={};let s=e.match(Settings.regexp_property);e=e.replace(Settings.regexp_property,""),s=null!==s&&0<s.length?s[0].slice(1,-1):"",s=s.split(";");for(let n=0;n<s.length;n++)if(o=s[n].split("="),2===o.length){if(""===o[0].trim())continue;t.properties[o[0].trim()]=o[1].trim()}return t.tag=e.match(Settings.regexp_tagName),t.id=e.match(Settings.regexp_id),t.class=e.match(Settings.regexp_class),t.child=e.match(Settings.regexp_childUI),t.include=e.match(Settings.regexp_include),null!==t.tag&&(t.tag=t.tag[0].slice(1).trim()),null!==t.id&&(t.id=t.id[0].slice(1).trim()),null!==t.class&&(t.class=t.class[0].slice(1).trim()),null!==t.child&&(t.child=t.child[0].slice(1).trim()),null!==t.include&&(t.include=t.include[0].slice(3).trim()),t}function buildScheme(e,n,t,r,o){"boolean"!=typeof o&&(o=!1);let s,d;if("object"==typeof t)for(let l in t){if(!t.hasOwnProperty(l))continue;if(e.hasOwnProperty(l))continue;if("string"==typeof t[l]?s=parseParameters(t[l]):"object"==typeof t[l]&&(n.rules.hasOwnProperty(l)?s=parseParameters(n.rules[l]):s={id:null,class:makeClassName(l),tag:"div",child:null,include:null,attributes:{},properties:{},parameters:{}}),Settings.devMode){let e=uiRegistry.get(s.child);if(null!==e&&n.dependencies.hasOwnProperty(l)){let t=n.dependencies[l];for(let n=0,r=t.length;n<r;n++)e.isImplementationOf(t[n])||error("UI \""+e.name+"\" does't implement interface \""+t[n]+"\".")}}(""===s.class||null===s.class)&&(s.class=makeClassName(l));let p=makeClassName(n.name);n.scheme===t&&s.class!==p&&(s.class=p+" "+s.class),s.name=l;let c=new Element(s);if(c.__.uiinstance=e,c.__.node.uiinstance=e,c.__.instance=e,c.__.node.instance=e,null!==s.include){let e=uiRegistry.get(s.include);if(null!==e){if(Settings.devMode&&n.dependencies.hasOwnProperty(l)){let t=n.dependencies[l];for(let n=0;n<t;n++)e.isImplementationOf(t[n])||error("UI \""+e.name+"\" does't implement interface \""+t[n]+"\".")}for(let t in e.__.params)!s.parameters.hasOwnProperty(t)&&e.__.params.hasOwnProperty(t)&&(s.parameters[t]=e.__.params[t]);c.__.inclusion=c.add(e,s.parameters)}else throw new RenderingException("Required for including UI \""+s.include+"\" is not registered yet.")}if(null!==e.__.localization&&null!==e.__.translations&&e.__.translations.hasOwnProperty(c.__.name)&&(null===c.__.inclusion?(c.__.node.setAttribute("localization",e.__.localization),c.__.node.T=e.__.translations[c.__.name]):c.__.inclusion.triggerEvent("localization",e.__.localization,e.__.translations[c.__.name])),e[l]=c,n.translations.hasOwnProperty(l)){let e=L10n.getTranslations(n.localization);"INPUT"===c.__.node.tagName?c.attr("placeholder",e(n.translations[l])):null===c.__.inclusion&&c.text(e(n.translations[l]))}if(r instanceof Element?(c.__.parent=r,r[l]=c,d=r.__.node):"string"==typeof r?d=document.querySelector(r):d=r,null!==r)if(o){let e=d.firstChild;null===e?d.appendChild(c.__.node):d.insertBefore(c.__.node,e)}else d.appendChild(c.__.node);"object"==typeof t[l]&&buildScheme(e,n,t[l],c)}}function filterUIParameterValue(e){let t=/^\d+(\.?\d+)?$/i;return"null"===e?e=null:"true"===e?e=!0:"false"===e?e=!1:t.test(e)&&(e=+e),e}function checkUIParameters(e){if(!e.hasOwnProperty("name"))throw new UIRegistrationException$1("Name of a new UI is not defined.");if("string"!=typeof e.name)throw new UIRegistrationException$1("Name of a new UI is "+typeof e.name+". String required.");if(null!==uiRegistry.get(e.name))throw new UIRegistrationException$1("UI with name \""+e.name+"\" already registered.");if(e.hasOwnProperty("scheme")||(e.scheme={}),"object"!=typeof e.scheme)throw new UIRegistrationException$1("Scheme for a new UI \""+e.name+"\" is "+typeof e.scheme+". Object required.");if(e.hasOwnProperty("rules")||(e.rules={}),"object"!=typeof e.rules)throw new UIRegistrationException$1("Rules for a new UI \""+e.name+"\" is "+typeof e.rules+". Object required.")}function Instance(){Object.defineProperty(this,"__",{value:{},configurable:!1,enumerable:!1,writeable:!1}),this.__.extensions={},this.__.events={},this.__.dispatchers={},this.__.eventsTimeouts={},this.__.ui=null,this.__.parent=null,this.__.data=null,this.__.params={}}function generateCSS(e,t,n){t===void 0&&(t="");let r=[];for(let o in e){if(!e.hasOwnProperty(o))continue;let d=e[o],l="",s,p;if(!this.elements.hasOwnProperty(o)&&"@"===o[0]){if("@keyframes"===o.slice(0,10)){for(let e in l+=o+"{\n",d)if(d.hasOwnProperty(e))if("string"==typeof d[e])l+="    "+makeClassName(e)+": "+(""===d[e]?"\"\"":d[e])+";\n";else if("object"==typeof d[e]){let t="    "+e+" {\n";for(let n in d[e])d[e].hasOwnProperty(n)&&(t+="        "+makeClassName(n)+": "+d[e][n]+";\n");t+="    }\n",l+=t}l+="}\n",r.push(l)}else"object"==typeof d&&(l+=t+o+"{\n",l+=generateCSS.call(this,d),l+="}\n",r.push(l));continue}this.elements.hasOwnProperty(o)?(p=parseParameters(this.elements[o].rules),s=null===p.id?"."+(null===p.class?makeClassName(o):p.class.split(" ").join(".")):"#"+p.id,s=(this.elements.hasOwnProperty(n)&&this.elements[n].children.hasOwnProperty(o)?" > ":" ")+s):s=makeClassName(o);let c=makeClassName(this.name),u=this.getRootElement();if(null!==u){p=parseParameters(u.rules);let e=null===p.class?makeClassName(u.name):p.class.split(" ").join(".");u===this.elements[o]&&(s=""),c=null===p.id?"."+makeClassName(this.name)+"."+e:"#"+p.id}(0<=t.indexOf(c)||0<=s.indexOf(c))&&(c="");let g=r.length;for(let e in r.push(""),l+=((c+" "+t).trim()+s).replace("  "," ").replace(" :",":").replace(">:",":")+"{\n",d){if(!d.hasOwnProperty(e))continue;let n=d[e];if("string"==typeof n||"number"==typeof n){let t=n;"content"==e&&(t="attr("===n.slice(0,5)?n:""===n?"\"\"":"\""+n+"\""),l+="    "+makeClassName(e)+": "+t+";\n"}else if(void 0!==n.getValue)l+="    "+makeClassName(e)+": "+n.getValue()+";\n";else if("object"==typeof n){let d={};d[e]=n,r.push(generateCSS.call(this,d,t+s,o))}}l+="}\n",r[g]=l}return r.join("\n")}function interfaceManager(e){return interfaces.hasOwnProperty(e)?interfaces[e]:null}function createResetStyles(e){e===void 0?e=resetStyles:resetStyles=e;let t=document.querySelector("style[data-reset=\"ui-builder\"]");if(null===t){t=document.createElement("style"),t.setAttribute("data-reset","ui-builder");let e=document.getElementsByTagName("head")[0];e.appendChild(t)}t.innerHTML=cssGenerator.generateSimpleStyles(e)}function Builder(e){return uiRegistry.get(e)}function getLayout(e){return layouts.hasOwnProperty(e)?layouts[e]:null}function Layout(e){return layouts.hasOwnProperty(e)?new LayoutUI(e):void error("Layout with name \""+e+"\" is not registered yet.")}function Color$1(e){return Object.defineProperty(this,"constructor",{enumerable:!1}),this instanceof Color$1?void this.attachValues("object"==typeof e?e:toColorObject(e)):new Color$1(e)}function toColorObject(e){let t=[],n=[],r=[],o,s,d,l,p,u,g,h,m,f,_;if(e=colorTrim(e.toLowerCase()),o=e.substr(0,1).toUpperCase(),s=e.substr(1),h=1,("R"===o||"Y"===o||"G"===o||"C"===o||"B"===o||"M"===o||"W"===o)&&!isNaN(s))if(6===e.length&&-1===e.indexOf(","));else e="ncol("+e+")";if(3===e.length||6===e.length||isNaN(e)||(e="ncol("+e+")"),0<e.indexOf(",")&&-1===e.indexOf("(")&&(e="ncol("+e+")"),"rgb"===e.substr(0,3)||"hsl"===e.substr(0,3)||"hwb"===e.substr(0,3)||"ncol"===e.substr(0,4)||"cmyk"===e.substr(0,4)){if("ncol"===e.substr(0,4)?(4===e.split(",").length&&-1===e.indexOf("ncola")&&(e=e.replace("ncol","ncola")),d="ncol",e=e.substr(4)):"cmyk"===e.substr(0,4)?(d="cmyk",e=e.substr(4)):(d=e.substr(0,3),e=e.substr(3)),l=3,u=!1,"a"===e.substr(0,1).toLowerCase()?(l=4,u=!0,e=e.substr(1)):"cmyk"===d&&(l=4,5===e.split(",").length&&(l=5,u=!0)),e=e.replace("(",""),e=e.replace(")",""),t=e.split(","),"rgb"===d){if(t.length!==l)return emptyObject();for(p=0;p<l;p++){if((""===t[p]||" "===t[p])&&(t[p]="0"),-1<t[p].indexOf("%")&&(t[p]=t[p].replace("%",""),t[p]=+(t[p]/100),3>p&&(t[p]=_Mathround(255*t[p]))),isNaN(t[p]))return emptyObject();255<parseInt(t[p])&&(t[p]=255),3>p&&(t[p]=parseInt(t[p])),3===p&&1<+t[p]&&(t[p]=1)}_={r:t[0],g:t[1],b:t[2]},!0===u&&(h=+t[3])}if("hsl"===d||"hwb"===d||"ncol"===d){for(;t.length<l;)t.push("0");for(("hsl"===d||"hwb"===d)&&360<=parseInt(t[0])&&(t[0]=0),p=1;p<l;p++){if(-1<t[p].indexOf("%")){if(t[p]=t[p].replace("%",""),t[p]=+t[p],isNaN(t[p]))return emptyObject();t[p]/=100}else t[p]=+t[p];1<+t[p]&&(t[p]=1),0>+t[p]&&(t[p]=0)}"hsl"===d&&(_=hslToRgb(t[0],t[1],t[2]),m=+t[0],f=+t[1]),"hwb"===d&&(_=hwbToRgb(t[0],t[1],t[2])),"ncol"===d&&(_=ncolToRgb(t[0],t[1],t[2])),!0===u&&(h=+t[3])}if("cmyk"===d){for(;t.length<l;)t.push("0");for(p=0;p<l;p++){if(-1<t[p].indexOf("%")){if(t[p]=t[p].replace("%",""),t[p]=+t[p],isNaN(t[p]))return emptyObject();t[p]/=100}else t[p]=+t[p];1<+t[p]&&(t[p]=1),0>+t[p]&&(t[p]=0)}_=cmykToRgb(t[0],t[1],t[2],t[3]),!0===u&&(h=+t[4])}}else if("ncs"===e.substr(0,3))_=ncsToRgb(e);else{for(g=!1,n=getColorArr("names"),p=0;p<n.length;p++)if(e.toLowerCase()===n[p].toLowerCase()){r=getColorArr("hexs"),g=!0,_={r:parseInt(r[p].substr(0,2),16),g:parseInt(r[p].substr(2,2),16),b:parseInt(r[p].substr(4,2),16)};break}if(!1===g){for(e=e.replace("#",""),3===e.length&&(e=e.substr(0,1)+e.substr(0,1)+e.substr(1,1)+e.substr(1,1)+e.substr(2,1)+e.substr(2,1)),p=0;p<e.length;p++)if(!isHex(e.substr(p,1)))return emptyObject();for(t[0]=parseInt(e.substr(0,2),16),t[1]=parseInt(e.substr(2,2),16),t[2]=parseInt(e.substr(4,2),16),p=0;3>p;p++)if(isNaN(t[p]))return emptyObject();_={r:t[0],g:t[1],b:t[2]}}}return colorObject(_,h,m,f)}function cmykToRgb(e,t,n,o){let s,d,l;return s=255-255*_Mathmin(1,e*(1-o)+o),d=255-255*_Mathmin(1,t*(1-o)+o),l=255-255*_Mathmin(1,n*(1-o)+o),{r:s,g:d,b:l}}function ncolToRgb(e,t,n){let r,o,s;if(s=e,isNaN(e.substr(0,1))){if(r=e.substr(0,1).toUpperCase(),o=e.substr(1),""===o&&(o=0),o=+o,isNaN(o))return!1;"R"===r&&(s=.6*o),"Y"===r&&(s=60+.6*o),"G"===r&&(s=120+.6*o),"C"===r&&(s=180+.6*o),"B"===r&&(s=240+.6*o),"M"===r&&(s=300+.6*o),"W"===r&&(s=0,t=1-o/100,n=o/100)}return hwbToRgb(s,t,n)}function hwbToRgb(e,t,n){let r=[],o,s,d;for(s=hslToRgb(e,1,.5),r[0]=s.r/255,r[1]=s.g/255,r[2]=s.b/255,d=t+n,1<d&&(t=+(t/d).toFixed(2),n=+(n/d).toFixed(2)),o=0;3>o;o++)r[o]*=1-t-n,r[o]+=t,r[o]=+(255*r[o]);return{r:r[0],g:r[1],b:r[2]}}function ncsToRgb(e){let t,n,o,s,d,l,p,c,u,h,m,f,_,v,w,O,P,E;if(e=colorTrim(e).toUpperCase(),e=e.replace("(",""),e=e.replace(")",""),e=e.replace("NCS","NCS "),e=e.replace(/\s+/g," "),-1===e.indexOf("NCS")&&(e="NCS "+e),e=e.match(/^(?:NCS|NCS\sS)\s(\d{2})(\d{2})-(N|[A-Z])(\d{2})?([A-Z])?$/),null===e)return!1;if(t=parseInt(e[1],10),n=parseInt(e[2],10),o=e[3],"N"!==o&&"Y"!==o&&"R"!==o&&"B"!==o&&"G"!==o)return!1;if(s=parseInt(e[4],10)||0,"N"!==o){d=1.05*t-5.25,l=n,"Y"===o&&60>=s?u=1:"Y"===o&&60<s||"R"===o&&80>=s?(p="Y"===o?s-60:s+40,u=(_Mathsqrt(14884-_Mathpow(p,2))-22)/100):"R"===o&&80<s||"B"===o?u=0:"G"===o&&(p=s-170,u=(_Mathsqrt(33800-_Mathpow(p,2))-70)/100),"Y"===o&&80>=s?c=0:"Y"===o&&80<s||"R"===o&&60>=s?(p="Y"===o?s-80+20.5:s+20+20.5,c=(104-_Mathsqrt(11236-_Mathpow(p,2)))/100):"R"===o&&60<s||"B"===o&&80>=s?(p="R"===o?s-60-60:s+40-60,c=(_Mathsqrt(1e4-_Mathpow(p,2))-10)/100):"B"===o&&80<s||"G"===o&&40>=s?(p="B"===o?s-80-131:s+20-131,c=(122-_Mathsqrt(19881-_Mathpow(p,2)))/100):"G"===o&&40<s&&(c=0);let e;"Y"===o?e=(85-17/20*s)/100:"R"===o&&60>=s?e=0:"R"===o&&60<s?(p=s-60+35,e=(67.5-_Mathsqrt(5776-_Mathpow(p,2)))/100):"B"===o&&60>=s?(p=1*s-68.5,e=(6.5+_Mathsqrt(7044.5-_Mathpow(p,2)))/100):"B"===o&&60<s||"G"===o&&60>=s?e=.9:"G"===o&&60<s&&(p=s-60,e=(90-1/8*p)/100),p=(u+e+c)/3,h=(p-u)*(100-l)/100+u,m=(p-e)*(100-l)/100+e,f=(p-c)*(100-l)/100+c,_=h>m&&h>f?h:m>h&&m>f?m:f>h&&f>m?f:(h+m+f)/3,v=1/_,O=parseInt(255*(h*v*(100-d)/100),10),P=parseInt(255*(m*v*(100-d)/100),10),E=parseInt(255*(f*v*(100-d)/100),10),255<O&&(O=255),255<P&&(P=255),255<E&&(E=255),0>O&&(O=0),0>P&&(P=0),0>E&&(E=0)}else w=parseInt(255*(1-t/100),10),255<w&&(w=255),0>w&&(w=0),O=w,P=w,E=w;return{r:O,g:P,b:E}}function colorObject(e,t,n,r){let o,s,d,l,p,c,u;return e?(t||(t=1),o=rgbToHsl(e.r,e.g,e.b),s=rgbToHwb(e.r,e.g,e.b),d=rgbToCmyk(e.r,e.g,e.b),c=n||o.h,u=r||o.s,l=hueToNcol(c),p={red:e.r,green:e.g,blue:e.b,hue:c,sat:u,lightness:o.l,whiteness:s.w,blackness:s.b,cyan:d.c,magenta:d.m,yellow:d.y,black:d.k,ncol:l,opacity:t,valid:!0},p=roundDecimals(p),p):emptyObject()}function roundDecimals(e){return e.red=+e.red.toFixed(0),e.green=+e.green.toFixed(0),e.blue=+e.blue.toFixed(0),e.hue=+e.hue.toFixed(0),e.sat=+e.sat.toFixed(2),e.lightness=+e.lightness.toFixed(2),e.whiteness=+e.whiteness.toFixed(2),e.blackness=+e.blackness.toFixed(2),e.cyan=+e.cyan.toFixed(2),e.magenta=+e.magenta.toFixed(2),e.yellow=+e.yellow.toFixed(2),e.black=+e.black.toFixed(2),e.ncol=e.ncol.substr(0,1)+_Mathround(+e.ncol.substr(1)),e.opacity=+e.opacity.toFixed(2),e}function hueToNcol(e){for(;360<=e;)e-=360;return 60>e?"R"+e/.6:120>e?"Y"+(e-60)/.6:180>e?"G"+(e-120)/.6:240>e?"C"+(e-180)/.6:300>e?"B"+(e-240)/.6:360>e?"M"+(e-300)/.6:void 0}function rgbToHwb(e,t,n){let o,s,d;e/=255,t/=255,n/=255;let l=_Mathmax(e,t,n),p=_Mathmin(e,t,n),c=l-p;return o=0===c?0:e===l?360*((t-n)/c%6):t===l?360*(((n-e)/c+2)%6):360*(((e-t)/c+4)%6),s=p,d=1-l,{h:o,w:s,b:d}}function rgbToCmyk(e,t,n){let o,s,d,l;e/=255,t/=255,n/=255;let p=_Mathmax(e,t,n);return l=1-p,1===l?(o=0,s=0,d=0):(o=(1-e-l)/(1-l),s=(1-t-l)/(1-l),d=(1-n-l)/(1-l)),{c:o,m:s,y:d,k:l}}function emptyObject(){return{red:0,green:0,blue:0,hue:0,sat:0,lightness:0,whiteness:0,blackness:0,cyan:0,magenta:0,yellow:0,black:0,ncol:"R",opacity:1,valid:!1}}function hslToRgb(e,t,n){let o,s,d,l,p;return e/=60,s=.5>=n?n*(t+1):n+t-n*t,o=2*n-s,d=255*hueToRgb(o,s,e+2),l=255*hueToRgb(o,s,e),p=255*hueToRgb(o,s,e-2),{r:d,g:l,b:p}}function hueToRgb(e,t,n){return 0>n&&(n+=6),6<=n&&(n-=6),1>n?(t-e)*n+e:3>n?t:4>n?(t-e)*(4-n)+e:e}function rgbToHsl(e,t,n){let r=[],o,d,p,c,u,g,m;for(r[0]=e/255,r[1]=t/255,r[2]=n/255,o=r[0],d=r[0],g=0,p=0;p<r.length-1;p++)r[p+1]<=o&&(o=r[p+1]),r[p+1]>=d&&(d=r[p+1],g=p+1);return 0===g&&(m=(r[1]-r[2])/(d-o)),1===g&&(m=2+(r[2]-r[0])/(d-o)),2===g&&(m=4+(r[0]-r[1])/(d-o)),isNaN(m)&&(m=0),m*=60,0>m&&(m+=360),c=(o+d)/2,u=o===d?0:.5>c?(d-o)/(d+o):(d-o)/(2-d-o),{h:m,s:u,l:c}}function toHex(e){let t=e.toString(16);for(;2>t.length;)t="0"+t;return t}function isHex(e){return-1<"0123456789ABCDEFabcdef".indexOf(e)}function getColorArr(e){return"names"===e?["AliceBlue","AntiqueWhite","Aqua","Aquamarine","Azure","Beige","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","FloralWhite","ForestGreen","Fuchsia","Gainsboro","GhostWhite","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","RebeccaPurple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","WhiteSmoke","Yellow","YellowGreen"]:"hexs"===e?["f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","000000","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"]:void 0}function colorTrim(e){return e.replace(/^\s+|\s+$/g,"")}function XY(e,t){"object"==typeof e&&(e.hasOwnProperty("y")&&(t=e.y),e.hasOwnProperty("x")&&(e=e.x)),this.x=e===void 0?0:e,this.y=t===void 0?0:t}function Point$1(e,t){XY.call(this,e,t)}function Rect(e,t,n,r){Point$1.call(this,e,t),"object"==typeof e&&(e.hasOwnProperty("w")&&(n=e.w),e.hasOwnProperty("h")&&(r=e.h)),this.w=n===void 0?0:n,this.h=r===void 0?0:r}function Vector(e,t){Point$1.call(this,e,t)}function themesManager(e){return new StyleGetter(e)}function setCsrfToken(e){null===csrfToken&&("object"==typeof e?(csrfParam=Object.keys(e)[0],csrfToken=e[csrfParam]):"string"==typeof e&&(csrfToken=e))}function Url(e,t){for(let n in urlRefiners)e=urlRefiners[n](e,t);return e}function URL(e){if("string"==typeof e){this.url=e,this.params={};let t=e.split("?");if(this.path=t[0],1<t.length){let e=t[1].split("&");for(let t=0,n;t<e.length;t++)n=e[t].split("="),this.params[n[0]]=1<n.length?decodeURIComponent(n[1]):""}}else if(e instanceof URL)for(let t in this.url=e.url,this.path=e.path,this.params={},e.params)e.params.hasOwnProperty(t)&&(this.params[t]=e.params[t])}function RouteManager(e){e=e.replace("\\","/");let t=null;if(!routes.hasOwnProperty(e)){let n=e.split("/"),r=[],o,s,d;for(s=1;s<=n.length-1;s++){if(r.push("?"),d=r.join("/"),o=n.slice(s).join("/"),routes.hasOwnProperty(d+"/"+o)){t=routes[d+"/"+o];break}if(routes.hasOwnProperty("??/"+o)){t=routes["??/"+o];break}}for(r=[],s=n.length-1;1<=s;s--){if(r.push("?"),d=r.join("/"),o=n.slice(s).join("/"),routes.hasOwnProperty(o+"/"+d)){t=routes[o+"/"+d];break}if(routes.hasOwnProperty(o+"/??")){t=routes[o+"/??"];break}}}else t=routes[e];return t}function Route(e){this.route=e,this.params={},this.__={events:{},dispatchers:{}}}function switchLanguageTo(e){language=e,curTranslation=translations.hasOwnProperty(e)?translations[e]:translations.en,L10n$1.triggerEvent("langChange",e)}function L10n$1(e,t,n){return translate(curTranslation,e,t,n)}function translate(e,t,n,r){for(let o in void 0===r&&"object"==typeof n&&(r=n),e.hasOwnProperty(n)&&e[n].hasOwnProperty(t)?t=e[n][t]:L10n$1.loadTranslations(n),r)r.hasOwnProperty(o)&&(t=t.replace("{"+o+"}",r[o]));return t}function defaultTranslationsLoader(e,t){let n=new DataAjax({url:(localizationsPath+"/"+e+".json").replace("//","/"),method:"GET"});n.fetch(function(n){L10n$1.addTranslation(e,n),L10n$1.triggerEvent("translations",e),"function"==typeof t&&t()})}function updateTranslations(){let e=document.querySelectorAll("*[localization]");for(let n=0;n<e.length;n++)if(e[n].T!==void 0){let r=e[n].getAttribute("localization"),o=L10n$1.getTranslations(r);"INPUT"===e[n].tagName?e[n].setAttribute("placeholder",o(e[n].T)):e[n].innerText=o(e[n].T)}}function updateTranslationsByCategory(e){let n=L10n$1.getTranslations(e),t=document.querySelectorAll("*[localization=\""+e+"\"]");for(let r=0;r<t.length;r++)void 0!==t[r].T&&("INPUT"===t[r].tagName?t[r].setAttribute("placeholder",n(t[r].T)):t[r].innerText=n(t[r].T))}function GlobalEvents(){return"1.0.0"}function ajaxCollector(e){if("string"!=typeof this.url)return this.triggerEvent("error"),error("URL for the ajaxCollector is not a string ("+typeof this.url+" given)."),!1;let t=permanentRedirections.hasOwnProperty(this.url)?permanentRedirections[this.url]:this.url,n=this,r=new XMLHttpRequest;r.onprogress=t=>{t.lengthComputable&&this.triggerEvent("progress",Math.ceil(100*(t.loaded/t.total)))},r.onreadystatechange=function(t){if(4===this.readyState){if(0<=[302,303,307].indexOf(this.status)){let e=this.getResponseHeader("Location");(301===this.status||308===this.status)&&(""===e||null===e)&&(error("Invalid redirection url for \""+n.url+"\" (empty \"Location\" header)."),n.triggerErrorEvents(this.status)),permanentRedirections[n.url]=e;let r=n.triggerRedirectionEvents(this.status,e);r.defaultPrevented&&t.preventDefault()}else if(200===this.status){try{let e=this.getResponseHeader("X-Redirect");if(null!==e){let t=n.triggerRedirectionEvents(this.status,e);t.defaultPrevented||window.location.replace(e)}}catch(t){}let t=this.getResponseHeader("content-type"),r;r="string"==typeof t&&0<=t.indexOf("json")?JSON.parse(this.responseText):this.responseText,n.cache=null===n.cacheLifetime||0<n.cacheLifetime?r:null,n.triggerEvent("dataReady",r),n.triggerEvent("complete",r),DataAjax.triggerEvent("complete",n),n.triggerEvent("progress",100),"function"==typeof e&&e(r,n)}else{n.hasError=!0;let e=new Event("error",{cancelable:!0});n.triggerEvent("error",this.status,e),Ajax$1.triggerEvent("error",n,this.status,e),e=new Event("complete",{cancelable:!0}),n.triggerEvent("complete",this.status,e),Ajax$1.triggerEvent("complete",n,this.status,e)}n.lastFetchTime=Date.now(),n.ready=!0}};let o=[];if(!(this._prameters instanceof FormData))for(let e in this._parameters)"object"==typeof this._parameters[e]?o.push(encodeURIComponent(e)+"="+encodeURIComponent(JSON.stringify(this._parameters[e]))):o.push(encodeURIComponent(e)+"="+encodeURIComponent(this._parameters[e]));for(let s in r.open(this.method,t+("GET"===this.method&&0<o.length?(0>t.indexOf("?")?"?":"&")+o.join("&"):""),!0),Ajax$1.triggerEvent("send",n),n.triggerEvent("send"),n.headers)r.setRequestHeader(s,n.headers[s]);if(n.useCsrf&&null!==csrfToken&&r.setRequestHeader(csrfParam,csrfToken),"POST"===this.method.toUpperCase()){if(this._parameters instanceof FormData)return n.useCsrf&&null!==csrfToken&&this._parameters.append(csrfParam,csrfToken),r.send(this._parameters),!0;r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.useCsrf&&null!==csrfToken&&o.push(csrfParam+"="+csrfToken),r.send(o.join("&"))}else r.send();return!0}function UIWebSocketCollector(e){this.ws.send(this._parameters,t=>{e.call(this,t),this.triggerEvent("dataReady",this,t)})}function WS(e){window.WebSocket||warn("WebSocket is not supported by this browser.");let t=[WS.FORMAT_JSON,WS.FORMAT_TOKENIZED_JSON,WS.FORMAT_RAW];this.format=e.hasOwnProperty("format")&&0<=t.indexOf(e.format)?e.format:WS.FORMAT_TOKENIZED_JSON,this.url=e.url,this.authRequestMessage=e.authRequestMessage?e.authRequestMessage:null,this.authSuccessMessage=e.authSuccessMessage?e.authSuccessMessage:"authorized",this.authFailMessage=e.authFailMessage?e.authFailMessage:"authorization failed",this.conn=null,this.authorized=!1,this.reconnectionInterval=e.reconnectionInterval?e.reconnectionInterval:5e3,this.tokens={},this.__={events:{},dispatchers:{}}}function randomId(e){let t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function Message(e){for(let t in this.token=randomId(12)+Date.now(),e)e.hasOwnProperty(t)&&(this[t]=e[t])}function Identity(){return currentUser}function User(e){this.id=e.id||null,this.role=e.role||null,this.firstName=e.firstName||"",this.secondName=e.secondName||"",this.email=e.email||"",this.phone=e.phone||"",this.photo=new Photo(e.photo||{}),this.sign=e.sign||"",this.position=e.position||"",this.companyId=e.companyId||"",this.companyName=e.companyName||""}function Photo(e){this.small=e.small||"",this.medium=e.medium||"",this.large=e.large||""}function Format(e){return Format.date(e)}function formatDate(e,t){if(null===e||""===e)return"";0>e.indexOf(" ")&&(e+=" 01:00:00");let n=new Date(e),r=n.getFullYear(),o,s;"ru"===L10n$1.getLanguage()?(o=Format.monthShortName(n.getMonth()).toLowerCase(),s=n.getDate()):(o=Format.monthShortName(n.getMonth()),s=Format.ordinal(n.getDate()));let l="";for(let n=0;n<t.length;n++)l+="Y"===t[n]?r:"m"===t[n]?o:"d"===t[n]?s:t[n];return l}function EventsChannel(e){this.name=e,this.__={events:{},dispatchers:{},eventsTimeouts:{}}}function channelsManager(e){if("string"!=typeof e&&Selection.logging)return error("EventsChannel name must be a string but "+typeof e+" given."),null;if(channels.hasOwnProperty(e))return channels[e];let t=new EventsChannel(e);return channels[e]=t,t}function registerThrottleEventExtension(){Extension.register("Throttle event",{params:{delay:0,event:"input",callback:null},onApply(e){function t(e,t){o.apply(e,t)}let n=e.params,r=null,o=n.callback||n.handler;n.newCallback=function(){clearTimeout(r),r=setTimeout(t,n.delay,this,arguments)},e.target.on(n.event,n.newCallback)},onUpdate(e,t){function n(e,t){s.apply(e,t)}let r=e.params,o=null;for(let n in e.target.off(r.event,r.newCallback),t)t.hasOwnProperty(n)&&r.hasOwnProperty(n)&&(r[n]=t[n]);let s=r.callback||r.handler;r.newCallback=function(){clearTimeout(o),o=setTimeout(n,r.delay,this,arguments)},e.target.on(r.event,r.newCallback)},onRemove(e){let t=e.params;e.target.off(t.event,t.newCallback)}})}function registerPopoverExtension(){Extension.register("Popover",{params:{side:"top",hideOnBlur:!0,fadingTime:150,popover:null},onApply(e,t,n){null===n.popover&&(n.popover=document.createElement("div"))}})}function registerNumberFilterExtension(){Extension.register("Number filter",{params:{fractional:!0,negative:!0,precision:4,min:!1,max:!1},onApply(e){let t=e.target,n=e.params;return UI.isElement(t)||!UI.isInstance(t)||t.isImplementationOf("Input")?void(n.inputHandler=function(){let e=this.val().trim().replace(",",".").replace(/[^\d.-]/gi,"");if(0===e.length)return void this.val("");let t=e.split(".");2<t.length&&(t=t.slice(0,2)),n.fractional&&0<n.precision?1<t.length&&(t[1]=t[1].slice(0,n.precision-1)):t=[t[0]],"."===t[0][0]&&(t[0]="0"+t[0]),t[0]=n.negative&&"-"===t[0][0]?"-"+t[0].slice(1).replace(/[^\d]/g,""):t[0].replace("-",""),"-"===t[0]?e=t.join("."):(e=parseFloat(t.join(".")),(isNaN(e)||!1!==n.min&&e<n.min)&&(e=n.min),!1!==n.max&&e>n.max&&(e=n.max)),this.val(e),this.focus()},n.changeHandler=function(){let e=this.val().trim().replace(",",".").replace(/[^\d.-]/gi,"");"."===e[e.length-1]&&(e=e.slice(0,-1),this.val(e))},t.on("input",n.inputHandler),t.on("change",n.changeHandler)):void UI.error("Extension \""+e.name+"\": target doesn't implement \"Input\" interface:","\n\n",Interface("Input").toString(),"\n ")},onRemove(e){e.target.off("input",e.params.inputHandler),e.target.off("change",e.params.changeHandler)}})}function registerDragExtension(){function e(t,n){n.preventDefault();let e=this.extension("Drag");if(null===e&&(e=this.instance().extension("Drag")),null===e)return;let _=e.target,b=e.params.targetElement,v=new Event("dragStart",{cancelable:!0});if(_.triggerEvent("dragStart",t,v),_!==this&&this.triggerEvent("dragStart",t,v),v.defaultPrevented)return;g=e.params.x,h=e.params.y,m=e.params.withinParent,f=e.params.useBoundaries;let w=b.node().parentNode.style.position;m&&("static"===w||""===w)&&(b.node().parentNode.style.position="relative"),s=void 0===n.touches?n.clientX:n.touches[0].clientX,d=void 0===n.touches?n.clientY:n.touches[0].clientY;let O=b.clientRect();l=O.top,p=O.left,O=b.node().parentNode.getBoundingClientRect();let P=getComputedStyle(b.node().parentNode),E=parseInt((P.borderLeftWidth+"").replace("px","")),C=parseInt((P.borderTopWidth+"").replace("px",""));c=O.top+C,u=O.left+E,r=this,o=e,b.addClass("dragged")}function t(t){if(null===r)return;let e=r.extension("Drag");if(null===e&&(e=r.instance().extension("Drag")),null===e)return;let n=e.target,o=e.params.targetElement,_=void 0===t.touches?t.clientX:t.touches[0].clientX,b=void 0===t.touches?t.clientY:t.touches[0].clientY,v=_-s,w=b-d,O=m?l-c:l,P=m?p-u:p,E=P+v,C=O+w;if(f){if(0>E&&(E=0),m){let e=o.__.node.clientWidth,t=o.__.node.parentNode.clientWidth;E>t-e&&(E=t-e)}if(0>C&&(C=0),m){let e=o.__.node.clientHeight,t=o.__.node.parentNode.clientHeight;C>t-e&&(C=t-e)}}let T=new Event("drag",{cancelable:!0}),I=new Point(P,O),k=new Point(E,C),N=new Point(v,w);if(n.triggerEvent("drag",o.instance(),I,N,T),n!==o&&o.triggerEvent("drag",o.instance(),I,N,T),!T.defaultPrevented){let e={position:m?"absolute":"fixed"};g&&(e.left=k.x+"px"),h&&(e.top=k.y+"px"),o.css(e)}}function n(t){if(null!==r&&null!==o){let e=o.target,n=o.params.targetElement;e.triggerEvent("dragEnd",n.instance(),t),n.triggerEvent("dragEnd",n.instance(),t),n.removeClass("dragged")}r=null,o=null}Extension.register("Drag",{params:{x:!0,y:!0,withinParent:!0,useBoundaries:!1,handle:null},onApply(t){let n=t.target,r=t.params;if(r.targetElement=UI.isElement(n)?n:n.getRootElement(),null===r.handle){let e=n;if(UI.isElement(n)&&(e=n.instance()),!UI.isInstance(e))return void UI.error("Target for the \"Drag\" extension must be an instance or an element.");r.handle=e.isImplementationOf("Draggable")?e.getHandle():r.targetElement}r.handle.__.extensions.Drag=t,r.handle.on("mousedown",e),r.handle.on("touchstart",e)},onUpdate(e,t){let n=e.params;for(let r in t)t.hasOwnProperty(r)&&n.hasOwnProperty(r)&&(n[r]=t[r])},onRemove(t){t.params.handle.off("mousedown",e),t.params.handle.off("touchstart",e),delete t.params.handle.__.extensions.Drag},getDragged(){return r}});let r=null,o=null,s=0,d=0,l=0,p=0,c=0,u=0,g=!0,h=!0,m=!0,f=!1;document.addEventListener("mousemove",t),document.addEventListener("touchmove",t),document.addEventListener("mouseup",n),document.addEventListener("touchend",n)}function registerSortableExtension(){Extension.register("Sortable",{params:{x:!0,y:!0,placeholderClass:"placeholder"},onApply(e){function t(e){let t=document.createElement("div");t.className=r.placeholderClass,t.style.width=e.outerWidth()+"px",t.style.height=e.outerHeight()+"px",t.style.position="fixed",t.style.cursor="default !important",t.style.zIndex=1e6,document.body.appendChild(t),t.innerHTML=e.node().outerHTML,t.firstChild.style.opacity=d;let n=e.node().getElementsByTagName("input"),o=t.getElementsByTagName("input");for(let t=0;t<n.length;t++)o[t].value=n[t].value;return t}let n=e.target,r=e.params,o=null,s=null,d=1;r.downHandler=function(e,t,n,r){r.preventDefault()},r.dragStartHandler=function(e){UI.isInstance(this)&&(e=this);let t=e.getRootElement();d=""===t.node().style.opacity?d:t.node().style.opacity,t.css({opacity:.25})},r.dragHandler=function(e,d,l,p){p.preventDefault(),UI.isInstance(this)&&(e=this);let c=UI.isElement(this)?this:e.getRootElement();null===o&&(o=t(e.getRootElement()));let u=d.x+l.x,g=d.y+l.y;o.style.top=g+"px",o.style.left=r.x?u+"px":d.x+"px";let h=n.children();for(let t=0,r=h.length,o;t<r;t++){o=h[t].getRootElement(),null!==s&&(n.node().removeChild(s),s=null);let e=o.clientRect(),r=e.height/2;if(o!==c){if(null===o.node().previousSibling&&g<e.top+r||g<e.top+r&&g>e.top-r){if(o.node().previousSibling===c.node())continue;return s=document.createElement("div"),s.style.height=o.outerHeight()+"px",s.style.width="1px",void n.node().insertBefore(s,o.node())}if(null===o.node().nextSibling&&g>e.top+r||g>e.top+r&&g<e.top+e.height+r){if(o.node().nextSibling===c.node())continue;return s=document.createElement("div"),s.style.height=o.outerHeight()+"px",s.style.width="1px",null===o.node().nextSibling&&n.node().appendChild(s),void n.node().insertBefore(s,o.node().nextSibling)}}}},r.dropHandler=function(e){UI.isInstance(this)&&(e=this);let t=UI.isElement(this)?this:e.getRootElement();null!==o&&null!==o.parentNode&&(o.parentNode.removeChild(o),o=null),null!==s&&(t.node().parentNode.removeChild(t.node()),n.node().replaceChild(t.node(),s),s=null,n.triggerEvent("sort",t)),e.getRootElement().css({opacity:d||1})};let l=n.children();for(let t=0,n;t<l.length;t++)n=l[t],Extension("Drag").applyTo(n,{withinParent:!1,x:r.x,y:r.y}),n.on("dragStart",r.dragStartHandler),n.on("drag",r.dragHandler),n.on("dragEnd",r.dropHandler);n.on("add",e=>{e.applyExtension("Drag",{withinParent:!1,x:r.x,y:r.y}),e.on("dragStart",r.dragStartHandler),e.on("drag",r.dragHandler),e.on("dragEnd",r.dropHandler)})},onRemove(){},onUpdate(){}})}function registerTabExtension(){function e(e){let t=this.extension("Tab"),n=this.parent(),r=t.params.content.parent(),o=n.children(),s=t.params.activeClass,d=t.params.content;for(let t=0,n;t<o.length;t++)n=o[t].getRootElement(),null===n.extension("Tab")||n.removeClass(s);this.addClass(s),o=r.children();for(let t=0,n;t<o.length;t++)n=o[t].getRootElement(),n!==d&&n.removeClass(s).fadeOut(150);setTimeout(function(){d.addClass(s).fadeIn(150,"flex")},160),this.triggerEvent("ext:tab.click",e)}Extension.register("Tab",{params:{label:"",content:null,activeClass:"active"},onApply(n){let r=n.params;return null===r.content?void UI.warn("No content specified for the extension \"Tab\"."):void(""===r.label&&(r.label=t++ +"",1e7<t&&(t=0)),n.target.on("click",e))},onRemove(t){t.target.off("click",e)}});let t=0}function registerDropdownExtension(){Extension.register("Dropdown",{params:{side:"auto",target:null},onApply(e){let t=e.target,n=e.params,r=n.target;t.__._dropdownContent=r,r.css({display:"none"}),n.clickHandler=function(){let e=!this.hasClass("dropdown-expanded"),n=new Event("blur",{cancelable:!0});e?(t.addClass("dropdown-expanded"),r.addClass("dropdown-expanded"),n=new Event("expand",{cancelable:!0}),r.triggerEvent("expand",this,n),!n.defaultPrevented&&r.slideDown(100,()=>r.css({display:"flex"}))):(t.removeClass("dropdown-expanded"),r.removeClass("dropdown-expanded"),n=new Event("collapse",{cancelable:!0}),r.triggerEvent("collapse",this,n),!n.defaultPrevented&&r.slideUp(100,()=>r.css({display:"none"})))},t.on("click",n.clickHandler)},onRemove(e){e.target.off("click",e.params.clickHandler),delete e.target.__._dropdownContent}}),document.addEventListener("mousedown",function(t){let e=t.target;for(;null!==e;){if(UI.isElement(e.element)&&e.element.hasClass("dropdown-expanded")){e=e.element.node();break}e=e.parentNode}let n=document.getElementsByClassName("dropdown-expanded");n=Array.prototype.slice.call(n,0);for(let r=0,o=n.length;r<o;r++)if(n[r]!==e&&UI.isElement(n[r].element)&&UI.isElement(n[r].element.__._dropdownContent)){let t=n[r].element,o=t.__._dropdownContent;if(o.node()===e||t.node()===e)continue;t.removeClass("dropdown-expanded"),o.removeClass("dropdown-expanded");let s=new Event("collapse",{cancelable:!0});o.triggerEvent("collapse",o,s),s.defaultPrevented||o.slideUp(100,function(){o.css({display:"none"})})}})}function registerLoadMoreExtension(){Extension.register("Load more",{params:{url:"/load-more",method:"GET",form:null,type:"from",scrollThreshold:100,dummies:10,dummyClass:"dummy"},onApply(e){let t=e.target,n=e.params,r=n.form,o=n.type,s=0,d=null,l=n.dummies||0,p=n.dummyClass||"dummy",c=new Ajax({url:n.url,method:n.method,allowMultiple:!1}),u=!0;c.on("complete",()=>u=!0),n.loadHandler=e=>{if(Array.isArray(e)&&0<e.length){let e=t.node().getElementsByClassName(p);for(let n=0,r=e.length;n<r;n++)t.node().removeChild(e[0])}},t.on("load",n.loadHandler),n.afterLoadHandler=e=>{if(!(Array.isArray(e)&&0<e.length&&0<l))t.triggerEvent("loadMore",[]);else if(t.triggerEvent("loadMore",e),0<t.children().length)for(let e=0,n;e<l;e++)n=document.createElement("div"),n.className=p,t.node().appendChild(n)},t.on("afterLoad",n.afterLoadHandler),n.handler=()=>{let l=100*(t.scrollTop()/(t.scrollHeight()-t.outerHeight())),p=t.children(),g=p[p.length-1];if(u&&l>=n.scrollThreshold&&(1<=l||isNaN(l))&&250<=Date.now()-s&&d!==g){let n=null===r||r===void 0?{}:r.gatherData(!0);if(!("from"===o))n.offset=t.children().length;else if(g.isImplementationOf("Identified"))n.from=g.getId();else return void UI.error("Extension \""+e.name+"\": Last item doesn't implement \"Identified\" interface:","\n\n",Interface("Identified").toString(),"\n ");u=!1,s=Date.now(),c.params(n).fetch(e=>{s=Date.now();Array.isArray(e)&&(0===e.length&&(d=g),t.load(e,!1,!1))})}},t.on("scroll",n.handler)},onRemove(e){e.target.off("scroll",e.params.handler),e.target.off("scroll",e.params.loadHandler),e.target.off("scroll",e.params.afterLoadHandler)},onUpdate(){}})}function registerActiveTriggerExtension(){Extension.register("Active trigger",{params:{activeClass:"active"},onApply(e){let t=e.target,n=e.params,r=n.activeClass;n.handler=function(e,n){let o=n.target,s=t.node();for(;o.parentNode!==s&&o!==document.body&&null!==o;)o=o.parentNode;if(o.parentNode===s){let e=s.childNodes;for(let t=0;t<e.length;t++)e[t].classList.remove(r);o.classList.add(r)}},t.on("click",n.handler)},onRemove(e){e.target.off("click",e.params.handler)}})}function registerFormControlsInterfaces(){Interface.register("Form",["validate()","requireField(field)","submit()","reset()"]),Interface.register("Input",["val(value)","disable()","enable()","focus()","blur()","name(value)","placeholder(value)","required(value)"]),Interface.register("Button",["text(value)","disable()","enable()","focus()","blur()","onClick(handler)"]),Interface.register("Labeled",["label(value)"])}function registerComponentsInterfaces(){Interface.register("Spinner",["show()","hide()"]),Interface.register("Calendar",["outputFormat(template)","valueFormat(template)","format(template)","year(value)","month(value)","day(value)","daysInMonth(monthIndex)"]),Interface.register("Tabs",["localization(category)","addTab(label, target)","activeTab(label)","tabByLabel(label)","hideTab(label)","showTab(label)"]),Interface.register("Overlay",["trackProgress(ajax)","setSkeleton(name)","showSkeleton()","hideSkeleton()","close()"]),Interface.register("Alert",["info(title, message, image)","warn(title, message, image)","error(title, message, image)"])}function registerHelpersInterfaces(){Interface.register("Identified",["getId()","setId(id)"]),Interface.register("Translated",["translation(field, lang)"]),Interface.register("Progressive",["getProgress()","onComplete(callback)"]),Interface.register("Yes/No",["yes()","no()","onYes(callback)","onNo(callback)","onAnswer(callback)"]),Interface.register("Draggable",["getHandle()"])}function registerModalUI(){function e(e){e.close()}function t(n,r){50<_Mathabs(r.clientX-t._x)||50<_Mathabs(r.clientY-t._y)||r.target!==n.wrap.__.node||n.close()}L10n.addTranslation("modal",{ru:{"To top":"\u041D\u0430\u0432\u0435\u0440\u0445","To bottom":"\u0412\u043D\u0438\u0437","Loading...":"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430..."}}),UI.register({name:"Modal",localization:"modal",translations:{label:"Loading..."},scheme:{wrap:{scrollingButtons:{scrollTopButton:"(text = a)",scrollBottomButton:"(text = b)"},overlay:{closeButton:"(html = \u2715)",progressBar:{label:"",track:{bar:""}},skeleton:"",content:""}}},params:{width:"15rem",height:"6rem",scrollingButtons:!0,closeOnBlur:!0,closeButton:!0,skeleton:""},methods:{applyParams(e){return this.overlay.css({width:e.width,minHeight:e.height}),e.closeButton||this.closeButton.hide(),e.scrollingButtons?(this.content.on("load",function(){this.UII().updateScrollingButtons()}),this.content.on("renderInside",()=>{setTimeout(()=>{this.updateScrollingButtons()},1e3)})):this.scrollingButtons.hide(),!0===e.closeOnBlur&&(this.wrap.on("mousedown",(e,n)=>{t._x=n.clientX,t._y=n.clientY}),this.wrap.on("click",t)),this},setSkeleton(e){this.params().skeleton=e},showSkeleton(){let e=UI(this.params().skeleton);return null!==e&&0===this.skeleton.children().length&&e.renderTo(this.skeleton),this.skeleton.fadeIn(150,"flex"),this},hideSkeleton(){return this.skeleton.fadeOut(),this},trackProgress(e){this.bar.css({width:"10%"}),this.progressBar.css({display:"flex",opacity:1}),e.on("progress",e=>{let t=e/100*this.track.outerWidth();this.bar.animate({width:t+"px"},100)}),this.showSkeleton(),this.content.css({maxHeight:this.skeleton.outerHeight()+"px"}),e.on("complete",()=>{this.bar.css({boxShadow:"0 0 15px "+Theme("colors.secondary").alpha(.25).getValue()}),setTimeout(()=>{this.progressBar.fadeOut(500),this.content.css({maxHeight:"initial"}),this.hideSkeleton(),setTimeout(()=>{this.progressBar.hide()},500)},250)}),e.on("error",(e,t)=>{t.defaultPrevented||(t.preventDefault(),this.content.removeChildren(),404===e?UI("Not found message").renderTo(this.content):403===e?UI("Forbidden message").renderTo(this.content):500==e&&UI("Server error message").renderTo(this.content))})},hide(){return this.overlay.css({transform:"scale(1)"}),this.wrap.css({transition:"0.15s"}),setTimeout(()=>{this.wrap.removeClass("shown"),this.overlay.css({transform:"scale(1.2)"}),this.triggerEvent("hide"),this.triggerEvent("close"),setTimeout(()=>{this.remove()},150)},25),this},close(){this.hide()},scrollBottom(){let e=this.params(),t=this,n=this.wrap.scrollTop();return void 0!==e.ani&&e.ani.stop(),e.ani=new Animation({duration:1e3}),e.ani.run(function(e){t.wrap.scrollTop(n+(t.wrap.scrollHeight()-t.wrap.outerHeight()-n)*e)}),this},scrollTop(){let e=this.params(),t=this,n=this.wrap.scrollTop();e.ani!==void 0&&e.ani.stop(),e.ani=new Animation({duration:1e3}),e.ani.run(function(e){t.wrap.scrollTop(n+(0-n)*e)})},updateScrollingButtons(){return this.wrap.scrollHeight()<=this.wrap.outerHeight()?this.scrollingButtons.hide():this.scrollingButtons.show("flex"),this}},onRender(t,n){t.applyParams(n),t.wrap.addEventListener("scroll",function(e){let t=100*(this.__.node.scrollTop/(this.__.node.scrollHeight-this.__.node.offsetHeight));e.overlay.css({transformOrigin:"center "+parseInt(t)+"%"})}),setTimeout(function(){t.wrap.addClass("shown"),setTimeout(function(){t.overlay.css({transform:"initial"})},250)},50),t.closeButton.on("click",e),t.scrollTopButton.on("click",e=>e.scrollTop()),t.scrollBottomButton.on("click",e=>e.scrollBottom())},onLoad(e,t,n){n.preventDefault(),e.content.load(t)},styles:{"@media print":{".overlay":{boxShadow:"none"}},wrap:{display:"flex",position:"fixed",flexDirection:"column",top:0,left:0,width:"100%",height:"100%",backgroundColor:"transparent",justifyContent:"flex-start",alignItems:"center",overflowY:"auto",zIndex:1e3,transition:"0.75s",".shown":{backgroundColor:"rgba(0,0,0,0.25)"},".shown > div":{opacity:1,transform:"scale(1)"},scrollingButtons:{display:"none",flexDirection:"column",width:"50%",height:"100%",position:"fixed",right:"9px",top:0," > *":{display:"flex",width:"100%",height:"50%",justifyContent:"flex-end",color:"rgba(255,255,255,0.75)",padding:"0.5rem 1rem",fontSize:"1.8rem",fontWeight:600,fontFamily:"Icons, sans-serif",transition:"0.25s"},scrollTopButton:{cursor:"default",alignItems:"flex-end",backgroundImage:"linear-gradient(-45deg, rgba(0, 0, 0, 0.15) 7%, rgba(0, 0, 0, 0.05) 7%, rgba(0, 0, 0, 0.05) 10%, transparent 10%)"},scrollBottomButton:{cursor:"default",backgroundImage:"linear-gradient(-135deg, rgba(0, 0, 0, 0.15) 7%, rgba(0, 0, 0, 0.05) 7%, rgba(0, 0, 0, 0.05) 10%, transparent 10%)"}," > *:hover":{backgroundColor:"rgba(0,0,0,0.12)"}},overlay:{display:"flex",flexDirection:"column",minWidth:"10rem",maxWidth:"calc(100% - 2rem)",minHeight:"6rem",backgroundColor:"#ffffff",borderRadius:Theme("overlay.borderRadius").default("0.15rem"),margin:"1rem 0",flexShrink:0,flexGrow:0,transform:"scale(1.2)",opacity:0,transition:"0.15s",boxShadow:"0 0 1rem rgba(0,0,0,0.25)",position:"relative",transformOrigin:"center top",overflow:"hidden",progressBar:{display:"none",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",width:"100%",height:"100%",position:"absolute",left:0,top:0,zIndex:1e5,label:{fontWeight:300,marginBottom:"0.5rem",color:"#555",fontSize:"0.85rem",marginTop:"3rem",display:"none"},track:{width:"100%",height:"0.25rem",backgroundColor:"#ddd",bar:{width:0,height:"0.25rem",backgroundColor:Theme("colors.secondary"),transition:"0.15s"}}},"> .buttons":{display:"flex",justifyContent:"flex-end",padding:"0.6rem",backgroundColor:Theme("colors.lightestGray")},skeleton:{width:"100%",display:"none",position:"absolute",top:0,left:0,backgroundColor:"#fff",minWidth:"20rem",zIndex:99999},content:{display:"flex",flexDirection:"column",overflow:"hidden",transition:"0.15s"},closeButton:{display:"flex",justifyContent:"center",alignItems:"center",width:"2.5rem",lineHeight:"2.5rem",height:"2.5rem",position:"absolute",top:0,right:0,cursor:"default",zIndex:5e3,":hover":{backgroundColor:"rgba(0,0,0,0.05)"}}}}}}),t._x=0,t._y=0}function registerTabsUI(){UI.register({name:"Tabs",scheme:{wrap:{labels:"|Tabs / Label",contents:"|Tabs / Content"}},methods:{addTab(e,t){void 0===t&&(t=this.contents.addOne().getRootElement());let n=this.labels.addOne({label:e});return n.getRootElement().applyExtension("Tab",{label:e,content:t}),this.activateTab(0),n},removeTab(e){let t=this.getTabByLabel(e);return null===t?this:(t.getLabel().removeExtension("Tab"),t.getLabel().hasClass("active")&&this.activateTab(0),t.remove(),this)},hideTab(e){let t=this.getTabByLabel(e),n=0;return(this.getTabByIndex(0)===t&&(n=1),null===t)?this:(t.getLabel().hasClass("active")&&this.activateTab(n),t.getLabel().hide(),this)},showTab(e){let t=this.getTabByLabel(e);return null===t?this:(t.getLabel.show("flex"),this)},getContentFor(e){let t=this.getTabByLabel(e);return null===t?null:t.getContent()},hideAllContents(){let e=this.contents.children();for(let t=0;t<e.length;t++)e[t].getRootElement().hide()},deactivateAllLabels(){let e=this.labels.children();for(let t=0;t<e.length;t++)e[t].getRootElement().removeClass("active")},getTabByLabel(e){let t=this.labels.children();for(let n=0;n<t.length;n++)if(t[n].params().label===e)return t[n];return null},getTabByIndex(e){let t=this.labels.children();for(let n=0;n<t.length;n++)if(n===e)return t[n];return null},getTab(e){let t=this.getTabByLabel(e);return null===t&&(t=this.getTabByIndex(e)),t},activateTabByLabel(e){this.hideAllContents(),this.deactivateAllLabels();let t=this.getTabByLabel(e);return null!==t&&(t.getLabel().addClass("active"),t.getContent().addClass("active").show()),this},activateTabByIndex(e){this.hideAllContents(),this.deactivateAllLabels();let t=this.getTabByIndex(e);return null!==t&&(t.getLabel().addClass("active"),t.getContent().addClass("active").show()),this},activateTab(e){this.hideAllContents(),this.deactivateAllLabels();let t=this.getTab(e);return null!==t&&(t.getLabel().addClass("active"),t.getContent().addClass("active").show()),this},removeAllTabs(){let e=this.contents.children();for(let t=0;t<e.length;t++)e[t].remove();return this}}}),UI.register({name:"Tabs / Label",scheme:{wrap:""},params:{label:""},methods:{getLabel(){return this.wrap},getContent(){return this.wrap.extension("Tab").params.content}},onRender(e,t){e.wrap.text(t.label)}}),UI.register({name:"Tabs / Content",scheme:{wrap:""}})}function registerDefaultTheme(){Theme.register("Default",{colors:{},fonts:{}})}function registerDarkTheme(){Theme.register("Dark",{colors:{},fonts:{}})}function registerLightTheme(){Theme.register("Light",{colors:{},fonts:{}})}var _Mathmax=Math.max,_Mathmin=Math.min,_Mathround=Math.round,_Mathasin=Math.asin,_Mathabs=Math.abs,_Mathsqrt=Math.sqrt,_Mathpow=Math.pow,_Mathsin=Math.sin,_Mathcos=Math.cos,_MathPI=Math.PI;let Settings={regexp_id:/#\w+[_\-\w]*/ig,regexp_tagName:/@\w+[_\-\w]*/ig,regexp_class:/\.\w+[_\-\w\s\d]*/ig,regexp_attribute:/\[(\w+[_\-\w]*\s*=\s*[^;=]+[/_\-\w\d.\s]*(\s*;\s*)?)+\]/ig,regexp_property:/\((\w+[_\-\w]*\s*=\s*[^;=]+[/_\-\w\d.\s]*(\s*;\s*)?)+\)/ig,regexp_params:/\{(\w+[_\-\w]*\s*=\s*[^;=]+[#\(\),/_\-\w\d.\s]*(\s*;\s*)?)+\}/ig,regexp_childUI:/\|\s*\w*[_\-\w\s/]+[_\-\w\d\s]*/ig,regexp_include:/<<<\s*\w*[/_\-\w\s]+[/_\-\w\d\s]*/ig,devMode:!0,logging:!0};Settings.setParsingRule=function(e,t){if("string"==typeof e){if(!Settings.hasOwnProperty("regexp_"+e))throw new SettingsException("Rule \""+e+"\" is absent in the settings.");if(a.constructor!==RegExp)throw new SettingsException("Trying to assign "+typeof t+" as parsing regular expression for "+e+".");Settings["regexp_"+e]=t}else if("object"==typeof e)for(let n in e)if(Settings.hasOwnProperty("regexp_"+n)){if(a.constructor!==RegExp)throw new SettingsException("Trying to assign "+typeof t+" as parsing regular expression for "+e+".");e.hasOwnProperty(n)&&(Settings["regexp_"+n]=e[n])}else throw new SettingsException("Rule \""+n+"\" is absent in the settings.")},Settings.enableLogging=function(e){Settings.logging=!1!==e},Exception.prototype={log:function(){if(!Settings.logging)return;if(""===this.message)return;let e="UIBuilder >>>";this.hasOwnProperty("name")&&(e+=" "+this.name),e+=" "+this.message,this.hasOwnProperty("type")&&"exception"!==this.type?"warning"===this.type?console.warn(e):console.log(e):console.error(e)}},UIRegistrationException$1.prototype=Exception.prototype,InvalidSchemeException.prototype=Exception.prototype,RenderingException.prototype=Exception.prototype;let logPrefix="UI",msgFormatter=null;msgFormatter=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)?chromeFormatter:defaultFormatter;let _extendings={},extendingsRegistry={add(e,t){_extendings[e]=t},get(e){return _extendings.hasOwnProperty(e)?_extendings[e]:null},delete(e){delete _extendings[e]}},_uis={},uiRegistry={add(e,t){_uis[e]=t},get(e){let t=_uis.hasOwnProperty(e)?_uis[e]:null;if(null===t){let t=extendingsRegistry.get(e);return null===t?null:(_uis[e]=t.extend(),extendingsRegistry.delete(e),_uis[e])}return t},getAll(){return _uis},remove(e){delete _uis[e]}};class EventsDispatcher{constructor(e){this.eventName=e,this.ports={}}onPort(e,t){if(this.ports.hasOwnProperty(e)&&delete this.ports[e],"function"!=typeof t)throw new EventException("Type of handler is not a function");this.ports[e]=t}runHandlers(e,t){for(let n in this.ports)this.ports.hasOwnProperty(n)&&this.ports[n].apply(e,t)}offPort(e){this.ports.hasOwnProperty(e)&&delete this.ports[e]}offAllPorts(){delete this.ports,this.ports={}}}class Extension$1{constructor(e,t){for(let n in void 0===t&&(t={}),this.name=e,this.params=t.params||{},this.__={events:{},eventsTimeouts:{},dispatchers:{}},t)t.hasOwnProperty(n)&&"function"==typeof t[n]&&2<n.length&&"on"===n.slice(0,2)?this.on(n.slice(2).toLowerCase(),t[n]):this.hasOwnProperty(n)||(this[n]=t[n])}applyTo(e,t){let n=new ExtensionInstance(e,this);for(let r in t)t.hasOwnProperty(r)&&n.params.hasOwnProperty(r)&&(n.params[r]=t[r]);return e.hasOwnProperty("__")&&e.__.hasOwnProperty("extensions")&&(e.__.extensions[this.name]=n),this.triggerEvent("apply",n,e,n.params),extensionsManager.triggerEvent("apply",n),n}removeFrom(e){if(e.hasOwnProperty("__")&&e.__.hasOwnProperty("extensions")){let t=e.__.extensions[this.name];t instanceof ExtensionInstance&&(t.triggerEvent("remove"),this.triggerEvent("remove",t))}}}addEventsMethods(Extension$1.prototype);class ExtensionInstance{constructor(e,t){this.name=t.name,this.target=e,this.params=cloneSimpleObject(t.params),this.vars={}}update(e){let t=extensionsManager(this.name);null!==t&&t.triggerEvent("update",this,e)}remove(){let e=extensionsManager(this.name);null!==e&&e.triggerEvent("remove",this)}}addEventsMethods(ExtensionInstance.prototype);let extensions={};addEventsMethods(extensionsManager),extensionsManager.register=function(e,t){extensions.hasOwnProperty(e)&&error("Extension with name \""+e+"\" is already registered.");let n=new Extension$1(e,t);extensionsManager.triggerEvent("register",n),extensions[e]=n};class Animation$1{constructor(e){let t="number"==typeof e?e:250;"object"!=typeof e&&(e={}),this.start=e.start||0,this.end=e.end||1,this.duration=e.duration||t,this.f=e.f||"easeOutQuad",this.callback=e.callback,this.stopped=!1}run(e){let r=performance.now(),o=this.duration,s=()=>{if(this.stopped)return;let d=performance.now(),t=d-r,n=t/this.duration,l=f[this.f](n,t,0,1,this.duration);"function"==typeof e&&e(l),d<r+o?requestAnimationFrame(s):1!==l&&"function"==typeof e&&e(1,!0)};s()}stop(){this.stopped=!0}}let f={default:"easeOutQuad",swing:function(e,n,t,r,o){return f[f.default](e,n,t,r,o)},easeInQuad:function(e,n,r,o,s){return o*(n/=s)*n+r},easeOutQuad:function(e,n,r,o,s){return-o*(n/=s)*(n-2)+r},easeInOutQuad:function(e,n,r,o,s){return 1>(n/=s/2)?o/2*n*n+r:-o/2*(--n*(n-2)-1)+r},easeInCubic:function(e,n,r,o,s){return o*(n/=s)*n*n+r},easeOutCubic:function(e,n,r,o,s){return o*((n=n/s-1)*n*n+1)+r},easeInOutCubic:function(e,n,r,o,s){return 1>(n/=s/2)?o/2*n*n*n+r:o/2*((n-=2)*n*n+2)+r},easeInQuart:function(e,n,r,o,s){return o*(n/=s)*n*n*n+r},easeOutQuart:function(e,n,r,o,s){return-o*((n=n/s-1)*n*n*n-1)+r},easeInOutQuart:function(e,n,r,o,s){return 1>(n/=s/2)?o/2*n*n*n*n+r:-o/2*((n-=2)*n*n*n-2)+r},easeInQuint:function(e,n,r,o,s){return o*(n/=s)*n*n*n*n+r},easeOutQuint:function(e,n,r,o,s){return o*((n=n/s-1)*n*n*n*n+1)+r},easeInOutQuint:function(e,n,r,o,s){return 1>(n/=s/2)?o/2*n*n*n*n*n+r:o/2*((n-=2)*n*n*n*n+2)+r},easeInSine:function(e,n,t,r,o){return-r*_Mathcos(n/o*(_MathPI/2))+r+t},easeOutSine:function(e,n,t,r,o){return r*_Mathsin(n/o*(_MathPI/2))+t},easeInOutSine:function(e,n,t,r,o){return-r/2*(_Mathcos(_MathPI*n/o)-1)+t},easeInExpo:function(e,n,t,r,o){return 0===n?t:r*_Mathpow(2,10*(n/o-1))+t},easeOutExpo:function(e,n,t,r,o){return n===o?t+r:r*(-_Mathpow(2,-10*n/o)+1)+t},easeInOutExpo:function(e,n,r,o,s){return 0===n?r:n===s?r+o:1>(n/=s/2)?o/2*_Mathpow(2,10*(n-1))+r:o/2*(-_Mathpow(2,-10*--n)+2)+r},easeInCirc:function(e,n,r,o,s){return-o*(_Mathsqrt(1-(n/=s)*n)-1)+r},easeOutCirc:function(e,n,r,o,s){return o*_Mathsqrt(1-(n=n/s-1)*n)+r},easeInOutCirc:function(e,n,r,o,s){return 1>(n/=s/2)?-o/2*(_Mathsqrt(1-n*n)-1)+r:o/2*(_Mathsqrt(1-(n-=2)*n)+1)+r},easeInElastic:function(e,n,r,o,l){let d=1.70158,c=0,u=o;return 0===n?r:1===(n/=l)?r+o:(c||(c=.3*l),u<_Mathabs(o)?(u=o,d=c/4):d=c/(2*_MathPI)*_Mathasin(o/u),-(u*_Mathpow(2,10*(n-=1))*_Mathsin((n*l-d)*(2*_MathPI)/c))+r)},easeOutElastic:function(e,n,r,o,l){let d=1.70158,c=0,u=o;return 0===n?r:1===(n/=l)?r+o:(c||(c=.3*l),u<_Mathabs(o)?(u=o,d=c/4):d=c/(2*_MathPI)*_Mathasin(o/u),u*_Mathpow(2,-10*n)*_Mathsin((n*l-d)*(2*_MathPI)/c)+o+r)},easeInOutElastic:function(e,n,r,o,l){let d=1.70158,c=0,u=o;return 0===n?r:2==(n/=l/2)?r+o:(c||(c=l*(1.5*.3)),u<_Mathabs(o)?(u=o,d=c/4):d=c/(2*_MathPI)*_Mathasin(o/u),1>n?-.5*(u*_Mathpow(2,10*(n-=1))*_Mathsin((n*l-d)*(2*_MathPI)/c))+r:.5*(u*_Mathpow(2,-10*(n-=1))*_Mathsin((n*l-d)*(2*_MathPI)/c))+o+r)},easeInBack:function(e,n,r,o,l,d){return void 0===d&&(d=1.70158),o*(n/=l)*n*((d+1)*n-d)+r},easeOutBack:function(e,n,r,o,l,d){return void 0===d&&(d=1.70158),o*((n=n/l-1)*n*((d+1)*n+d)+1)+r},easeInOutBack:function(e,n,r,o,l,d){return void 0===d&&(d=1.70158),1>(n/=l/2)?o/2*(n*n*(((d*=1.525)+1)*n-d))+r:o/2*((n-=2)*n*(((d*=1.525)+1)*n+d)+2)+r},easeInBounce:function(e,n,t,r,o){return r-f.easeOutBounce(e,o-n,0,r,o)+t},easeOutBounce:function(e,n,r,o,s){return(n/=s)<1/2.75?o*(7.5625*n*n)+r:n<2/2.75?o*(7.5625*(n-=1.5/2.75)*n+.75)+r:n<2.5/2.75?o*(7.5625*(n-=2.25/2.75)*n+.9375)+r:o*(7.5625*(n-=2.625/2.75)*n+.984375)+r},easeInOutBounce:function(e,n,t,r,o){return n<o/2?.5*f.easeInBounce(e,2*n,0,r,o)+t:.5*f.easeOutBounce(e,2*n-o,0,r,o)+.5*r+t}};class Data{constructor(e){if(void 0===e&&(e={}),this.__={events:{},dispatchers:{},eventsTimeouts:{}},this.hasError=!1,this.ready=!0,this.cache=null,this.cacheLifetime=null,this.allowMultiple=!0,e.hasOwnProperty("collector")){if("function"!=typeof e.collector)throw new UIDataException("Collector must be a function but "+typeof e.collector+" given.");this.collector=e.collector}else this.collector=defaultCollector;let t=["fetch","complete","error","progress"];for(let n=0;n<t.length;n++)e.hasOwnProperty("on"+t[n])&&"function"==typeof e["on"+t[n]]&&this.on(t[n],e["on"+t[n]]);this.waitingLimit=e.hasOwnProperty("waitingTime")?parseInt(e.waitingTime):3e3,this.timeElapsed=0,this.lastFetchTime=Date.now(),this._parameters=e.hasOwnProperty("data")?e.data:e.hasOwnProperty("parameters")?e.parameters:{}}parameters(e){return void 0===e?this._parameters:(this._parameters=e,this)}params(e){return this.parameters(e)}fetch(e){return(this.hasError=!1,(this.allowMultiple||this.ready)&&"function"==typeof this.collector)?(this.triggerEvent("fetch"),this.ready=!1,this.collector(e)):("object"==typeof params&&(this.params=params),!1)}send(e){return this.fetch(e)}}addEventsMethods(Data.prototype),addEventsMethods(Data);class Element{constructor(e){for(let t in Object.defineProperty(this,"__",{value:{},configurable:!1,enumerable:!1,writeable:!1}),this.__.name=void 0===e.name?null:e.name,this.__.child=void 0===e.child?null:e.child,this.__.childParams=e.parameters||{},this.__.class=void 0===e.class?null:e.class,this.__.id=void 0===e.id?null:e.id,this.__.tag=null!==e.tag&&void 0!==e.tag?e.tag.toLowerCase():"div",this.__.inclusion=null,""===this.__.tag&&(this.__.tag="div"),this.__.node=document.createElement(this.__.tag),this.__.parent=null,this.__.uiinstance=null,this.__.instance=null,this.__.node.instance=null,this.__.node.uiinstance=null,this.__.node.element=this,this.__.node.uielement=this,this.__.extensions={},this.__.draggable=!1,this.__.dragX=!1,this.__.dragY=!1,this.__.isDragging=!1,this.__.dragWithinParent=!1,this.__.dragBoundaries=!1,this.__.localization=null,this.__.translation=null,this.__.tabContainer=null,this.__.animation=null,this.__.fx=null,this.__.data=void 0===e.data?null:e.data,this.__.children=[],this.__.events={},e.attributes)e.attributes.hasOwnProperty(t)&&this.__.node.setAttribute(t,e.attributes[t]);for(let t in e.properties)e.properties.hasOwnProperty(t)&&(Element.prototype.hasOwnProperty(t)&&"function"==typeof Element.prototype[t]?Element.prototype[t].call(this,e.properties[t]):this.__.node[t]=e.properties[t]);"string"==typeof this.__.class&&(this.__.node.className=this.__.class),"string"==typeof this.__.id&&(this.__.node.id=this.__.id)}}Element.prototype.applyExtension=function(e,t){if(this.__.extensions.hasOwnProperty(e))return warn("Extension with name \""+e+"\" is already applied to the element."),!1;let n=extensionsManager(e);return null===n?(error("Extension with name \""+e+"\" is not registered yet."),!1):(this.__.extensions[e]=n.applyTo(this,t),!0)},Element.prototype.extension=function(e){return this.__.extensions.hasOwnProperty(e)?this.__.extensions[e]:null},Element.prototype.removeExtension=function(e){if(!this.__.extensions.hasOwnProperty(e))return!1;let t=this.__.extensions[e];return void 0!==t.remove&&(t.remove(),delete this.__.extensions[e],!0)},Element.prototype.updateExtension=function(e,t){if(!this.__.extensions.hasOwnProperty(e))return!1;let n=this.__.extensions[e];return void 0!==n.update&&(n.update(t),!0)},Element.prototype.applyLocalization=function(e,t){return this.__.node.setAttribute("localization",e),this.__.node.T=t,this},Element.prototype.hasChildUI=function(){return null!==this.__.child},Element.prototype.node=function(){return this.__.node},Element.prototype.scrollTop=function(e){return void 0===e?this.__.node.scrollTop:(this.__.node.scrollTop=e,this)},Element.prototype.scrollHeight=function(){return this.__.node.scrollHeight},Element.prototype.setChildUI=function(e){return"string"==typeof e?this.__.child=e:void 0!==e.render&&(this.__.child=e.name),this},Element.prototype.getChildUI=function(){return uiRegistry.get(this.__.child)},Element.prototype.hasInclusion=function(){return null!==this.__.inclusion&&1===this.__.children.length&&this.__.children[0].__!==void 0},Element.prototype.findTopLocalParent=function(){let e=this;for(;e instanceof Element&&!(null===e.__.parent);)if(e.__.parent instanceof Element&&e.__.parent.__.instance===this.__.instance)e=e.__.parent;else break;return e===this?null:e},Element.prototype.inclusion=function(){return this.__.inclusion},Element.prototype.instance=function(){return this.__.instance},Element.prototype.UII=function(){return this.__.instance},Element.prototype.parent=function(){return this.__.parent},Element.prototype.parentUII=function(){return null===this.instance()?null:this.UII().parentUII()},Element.prototype.parentInstance=function(){return null===this.instance()?null:this.UII().parentUII()},Element.prototype.children=function(){return this.__.children},Element.prototype.getAllChildElements=function(){let e=this.__.node.childNodes,t=[];for(let n=0,r=e.length;n<r;n++)e[n].uielement instanceof Element&&t.push(e[n].uielement);return t},Element.prototype.getAllNearbyElements=function(){let e=this.__.node.parentNode.childNodes,t=[];for(let n=0,r=e.length;n<r;n++)e[n].element instanceof Element&&e[n].element!==this&&t.push(e[n].element);return t};let nativeEvents=["submit","abort","beforeinput","blur","click","compositionen","paste","compositionstart","compositionupdate","dblclick","error","focus","change","focusin","focusout","input","keydown","keypress","keyup","load","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mousewheel","mouseup","resize","scroll","select","unload","wheel","touchstart","touchend","touchmove"];Element.prototype.addEventListener=function(e,t){return(e=e.toLowerCase(),"function"!=typeof t)?void error("Invalid callback type given for the event \""+e+"\"."):("on"===e.slice(0,2)&&(e=e.slice(2)),this.__.events.hasOwnProperty(e)||(this.__.events[e]=[]),0<=this.__.events[e].indexOf(t))?(warn("Handler for the event \""+e+"\" already added."),this):(this.__.events[e].push(t),0<=nativeEvents.indexOf(e)&&this.__.node.addEventListener(e,runElementHandlers),this)},Element.prototype.on=Element.prototype.addEventListener,Element.prototype.removeEventListener=function(e,t){if(e=e.toLowerCase(),"on"===e.slice(0,2)&&(e=e.slice(2)),!this.__.events.hasOwnProperty(e))return this;let n=this.__.events[e].indexOf(t);return 0>n?this:(this.__.events[e].splice(n,1),this)},Element.prototype.removeAllEventListeners=function(e){return("on"===e.slice(0,2)&&(e=e.slice(2)),!this.__.events.hasOwnProperty(e))?this:(this.__.events[e]=null,delete this.__.events[e],this.__.node.removeEventListener(e,runElementHandlers),this)},Element.prototype.off=function(e,t){return e=e.toLowerCase(),void 0===t?this.removeAllEventListeners(e):this.removeEventListener(e,t),this},Element.prototype.triggerEvent=function(e){e=e.toLowerCase();let t=[],n;for(n=1;n<arguments.length;n++)t.push(arguments[n]);if("on"===e.slice(0,2)&&(e=e.slice(2)),!this.__.events.hasOwnProperty(e))return this;let r=this.__.events[e];for(n=0;n<r.length;n++)r[n].apply(this,t)},Element.prototype.removeChildren=function(){for(let e=0,t=this.__.children.length;e<t;e++)this.__.children[0].remove();return this.__.children=[],this},Element.prototype.remove=function(){null===this.__.node.parentNode||(this.__.node.parentNode.removeChild(this.__.node),delete this.__.node.uiinstance[this.__.name])},Element.prototype.addOne=function(e,t){if("object"!=typeof t&&(t="object"==typeof e?e:this.__.childParams),e=!0===e,null===this.__.child)return null;let n=uiRegistry.get(this.__.child);return null===n?null:this.add(n,e,t)},Element.prototype.addOneAfter=function(e,t){if("object"!=typeof t&&(t={}),void 0===e.isImplementationOf)return error("Invalid parameter given for the element method \"addOneAfter()\" - instance is required but "+typeof e+" given.");if(null===this.__.child)return null;let n=uiRegistry.get(this.__.child);return null===n?null:this.addAfter(n,e,t)},Element.prototype.addOneBefore=function(e,t){if("object"!=typeof t&&(t={}),void 0===e.isImplementationOf)return error("Invalid parameter given for the element method \"addOneBefore()\" - instance is required but "+typeof e+" given.");if(null===this.__.child)return null;let n=uiRegistry.get(this.__.child);return null===n?null:this.addBefore(n,e,t)},Element.prototype.add=function(e,t,n){(void 0===t||null===t)&&(t=!1),"string"==typeof e&&(e=uiRegistry.get(e),null===e&&error("UI with name "+e+" is absent.")),void 0===e.renderTo&&error("First argument of the add() method must be UI or string");let r=e.renderTo(this,t,n);return this.triggerEvent("add",r),r.__.parent=this,r},Element.prototype.addAfter=function(e,t,n){if(void 0===t.isImplementationOf)return error("First argument for the method \"addAfter()\" is not instance."),null;if("string"==typeof e&&(e=_uibuilder(e),null===e))throw new InvalidParamException("UI with name "+e+" is absent.");if(void 0===e.prepare)throw new InvalidParamException("First argument of the addAfter() method must be UI or string");let r=e.prepare(n),o=new Event("beforeAdd",{cancelable:!0});if(this.triggerEvent("beforeAdd",r,o),o.defaultPrevented)return null;let s=t.getLastRootElement();r.appendAfter(s),r.__.parent=this;let d=s.parent();if(d.hasChildUI()){let e=d.__.children;if(1>=e.length)d.__.children.push(r);else for(let n=0;n<e.length;n++)if(e[n]===t){d.__.children.splice(n,0,r);break}}return r.triggerEvent("render",n),e.triggerEvent("render",r,n),this.triggerEvent("add",r),r},Element.prototype.addBefore=function(e,t,n){if(void 0===t.isImplementationOf)return error("First argument for the method \"addAfter()\" is not instance."),null;if("string"==typeof e&&(e=_uibuilder(e),null===e))throw new InvalidParamException("UI with name "+e+" is absent.");if(void 0===e.prepare)throw new InvalidParamException("First argument of the addAfter() method must be UI or string");let r=e.prepare(n),o=new Event("beforeAdd",{cancelable:!0});if(this.triggerEvent("beforeAdd",r,o),o.defaultPrevented)return null;let s=t.getFirstRootElement();r.appendBefore(s),r.__.parent=this;let d=s.parent();if(d.hasChildUI()){let e=d.__.children;if(1>=e.length)d.__.children.unshift(r);else for(let n=0;n<e.length;n++)if(e[n]===t){0==n?d.__.children.unshift(r):d.__.children.splice(n-1,0,r);break}}return r.triggerEvent("render",n),e.triggerEvent("render",r,n),this.triggerEvent("add",r),r},Element.prototype.html=function(html,runScripts){if(void 0===html)return this.__.node.innerHTML;if(this.__.node.innerHTML=html,!0===runScripts){let scripts=html.match(/<script>(\n*.*\n*)*<\/script>/gi);for(let i=0,script;i<scripts.length;i++)script=scripts[i].replace("<script>","").replace("</script>",""),eval(script)}return this},Element.prototype.text=function(e){return void 0===e?this.__.node.textContent:(this.__.node.textContent=e,this)},Element.prototype.attr=function(e,t){return void 0===t?this.__.node.hasAttribute(e)?this.__.node.getAttribute(e):"":(this.__.node.setAttribute(e,t),this)},Element.prototype.hasAttr=function(e){return this.__.node.hasAttribute(e)},Element.prototype.removeAttr=function(e){return this.__.node.removeAttribute(e)},Element.prototype.prop=function(e,t){return void 0===t?this.__.node[e]:(this.__.node[e]=t,this)},Element.prototype.val=function(e){return void 0===e?this.__.node.value:(this.__.node.value=e,this)},Element.prototype.src=function(e){return("IMG"!==this.__.node.tagName&&warn("Calling [src()] method not on the image tag."),void 0===e)?this.__.node.src:(this.__.node.src=e,this)},Element.prototype.href=function(e){return void 0===e?this.__.node.href:(this.__.node.href=e,this)},Element.prototype.getContext=function(e){return void 0===e?this.__.node.getContext("2d"):this.__.node.getContext(e)},Element.prototype.width=function(e){return void 0===e?this.__.node.width:(this.__.node.width=e,this)},Element.prototype.height=function(e){return void 0===e?this.__.node.height:(this.__.node.height=e,this)},Element.prototype.outerWidth=function(){return this.__.node.offsetWidth},Element.prototype.outerHeight=function(){return this.__.node.offsetHeight},Element.prototype.hide=function(){return"none"===this.__.node.style.display?this:(this.__.node.oldDisplay=this.__.node.style.display,this.__.node.style.display="none",this)},Element.prototype.show=function(e){return"string"==typeof e?(this.__.node.style.display=e,this):"none"!==this.__.node.style.display&&null!==this.__.node.offsetParent?this:(this.__.node.style.display=this.__.node.hasOwnProperty("oldDisplay")&&"none"!==this.__.node.oldDisplay?this.__.node.oldDisplay:"flex",this)},Element.prototype.isHidden=function(){let e=this.computedStyle();return"none"===e.display},Element.prototype.isVisible=function(){let e=this.computedStyle();return"none"!==e.display&&"hidden"!==e.visibility},Element.prototype.contentHeight=function(){let e=this.__.node,t=e.style.cssText.match(/height\s*:\s*[\d\w%]+/i);t=null===t?"":t[0],e.style.height="auto";let n=parseInt(window.getComputedStyle(e).getPropertyValue("height").replace(/[^.\d]/i,""));return e.style.cssText=e.style.cssText.replace(/height\s*:\s*auto/i,t),n},Element.prototype.slideDown=function(e,t){return"number"!=typeof e&&(e=250),this.isHidden()&&this.css({height:0}),this.css({overflow:"hidden",display:"flex"}),this.animate({height:this.contentHeight()},e,function(){this.css({height:"auto"}),"function"==typeof t&&t.call(this)}),this.__.fx="slideDown",this},Element.prototype.slideUp=function(e,t){return 0===this.outerHeight()||this.isHidden()?this:("number"!=typeof e&&(e=250),this.animate({height:0},e,t),this.__.fx="slideUp",this)},Element.prototype.slideToggle=function(e,t){return"number"!=typeof e&&(e=250),0===this.node().clientHeight||this.isHidden()||"slideUp"===this.__.fx?this.slideDown(e,t):this.slideUp(e,t),this},Element.prototype.hasClass=function(e){return this.__.node.classList.contains(e)},Element.prototype.hasClasses=function(e){for(let t=0;t<e.length;t++)if(!this.__.node.classList.contains(e[t]))return!1;return!0},Element.prototype.addClass=function(e){if("string"==typeof e)this.__.node.classList.add(e);else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.__.node.classList.add(e[t]);else return this;return this.__.class=this.__.node.className,this},Element.prototype.removeClass=function(e){if("string"==typeof e)this.__.node.classList.remove(e);else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.__.node.classList.remove(e[t]);else return this;return this.__.class=this.__.node.className,this},Element.prototype.toggleClass=function(e){return this.__.node.classList.toggle(e),this.__.class=this.__.node.className,this},Element.prototype.css=function(e){if("string"==typeof e){let t=this.computedStyle(),n=t.hasOwnProperty(e)?t[e]:null;return null!==n&&0<=n.indexOf("px")&&(n=parseFloat(n.replace("px",""))),n}if("object"==typeof e)for(let t in e)e.hasOwnProperty(t)&&(this.__.node.style[t]=e[t]);return this},Element.prototype.clientRect=function(){return this.__.node.getBoundingClientRect()},Element.prototype.tagName=function(){return this.__.node.tagName},Element.prototype.computedStyle=function(){return getComputedStyle(this.__.node)},Element.prototype.fadeIn=function(e,t,n){return("string"==typeof e&&void 0===t?t=e:"function"==typeof e&&void 0===n?n=e:"function"==typeof t&&null==n&&(n=t),"number"!=typeof e&&(e=250),this.isVisible()&&1===this.css("opacity"))?this:(void 0!==t&&this.css({display:t}),this.animate({opacity:1},e,n),this.__.fx="fadeIn",this)},Element.prototype.fadeOut=function(e,t,n){if(this.isHidden()||0===this.css("opacity"))return this;"function"==typeof e&&void 0===n?n=e:"function"==typeof t&&void 0==n&&(n=t),"number"!=typeof e&&(e=250),void 0===t&&(t=!0),this.animate({opacity:0},e,n),this.__.fx="fadeOut";let r=this;return t&&setTimeout(function(){r.css({display:"none"})},e),this},Element.prototype.fadeToggle=function(e,t,n){return this.isHidden()||0===this.css("opacity")||"fadeOut"===this.__.fx?this.fadeIn(e,t,n):this.fadeOut(e,!0===t,n),this},Element.prototype.animate=function(e,t,n){let r=this,o={},s=e,d={},l=this.computedStyle();for(let r in s)d[r]=l[r].replace(/[-\d.]/g,""),o[r]=parseFloat(l[r].toString().replace(/[^-\d.]/gi,"")),("width"==r||"maxWidth"==r||"minWidth"==r)&&0<(s[r]+"").indexOf("%")?(d[r]="%",o[r]=100*(o[r]/this.__.node.parentNode.offsetWidth)):("height"==r||"maxHeight"==r||"minHeight"==r)&&0<(s[r]+"").indexOf("%")&&(d[r]="%",o[r]=100*(o[r]/this.__.node.parentNode.offsetHeight)),s[r]=parseFloat(s[r].toString().replace(/[^-\d.]/gi,""));this.stopAnimation();let p=new Animation$1({duration:t,f:"easeInOutQuad"});return this.__.animation=p,this.__.animation.run(function(e,t){if(r.__.animation!==p||r.__.animation.stopped)return;let l={},c;for(let n in s){c=s[n]-o[n],0===c||(l[n]=parseFloat((c*e).toFixed(5))+o[n]+d[n])}r.css(l),t&&("function"==typeof n&&n.call(r),r.stopAnimation())}),this},Element.prototype.stopAnimation=function(){return null!==this.__.animation&&this.__.animation.stop(),this.__.animation=null,this.__.fx=null,this},Element.prototype.load=function(e,t,n){if("boolean"!=typeof t&&(t=!0),"boolean"!=typeof n&&(n=!1),e instanceof Data)return e.fetch(function(e,t,n){this.load(n,e,t)}.bind(this,t,n));else{let n=!0;if(null!==this.inclusion())n=!1;else if("object"==typeof e&&!Array.isArray(e))for(let t in n=!1,e)if(e.hasOwnProperty(t)&&!Element.prototype.hasOwnProperty(t)&&null!==uiRegistry.get(t)){n=!0;break}!0===t&&n&&(this.removeChildren(),this.html(""))}let r=new Event("load",{cancelable:!0});if(this.triggerEvent("load",e,r),r.defaultPrevented)return this;if("string"==typeof e||"number"==typeof e){let t=this.tagName();"IMG"===t||"VIDEO"===t||"IFRAME"===t?this.src(e):"INPUT"===t||"SELECT"===t?this.val(e):this.text(e)}else if("object"==typeof e){if(null!==this.inclusion())return this.inclusion().load(e,t,n),this;if(Array.isArray(e)){if(null===this.__.child)return warn("Trying to load children for Element \""+this.__.name+" @ "+this.__.uiinstance.__.ui.name+"\" without child UI."),this;let r;for(let o=0;o<e.length;o++)try{r=this.addOne(n),r.load(e[o],t,n)}catch(e){throw e}}else for(let r in e)if(e.hasOwnProperty(r))if("children"==r&&Array.isArray(e[r])&&this.hasChildUI())this.load(e[r],t,n);else if(Element.prototype.hasOwnProperty(r)&&"function"==typeof Element.prototype[r])Element.prototype[r].call(this,e[r]);else if(this.hasOwnProperty(r)&&this[r]instanceof Element)null===this[r].inclusion()?this[r].load(e[r]):this[r].inclusion().load(e[r]);else{let o=uiRegistry.get(r);null!==o&&o.renderTo(this).load(e[r],t,n)}}else warn("Trying to load unsupported data type ("+typeof e+") to tye element. Only string or object can be used.");return this.triggerEvent("afterLoad",e),this},Element.prototype.resetValues=function(){},Element.prototype.gatherData=function(e){void 0===e&&(e=!0);let t=createValueHolder(),n=new Event("gather");if(this.triggerEvent("gather",t,n),n.defaultPrevented||gatherElementData(this,t,t,null,!0),void 0===t.value()){let e={};for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);t=e}else t=t.value();return e&&"object"==typeof t&&compactData(t),t},Element.prototype.clone=function(){let e=new Element({});cloneObjectTo(this,e),cloneObjectTo(this.__,e.__);let t=this.node(),n=t.cloneNode(!0);return n.uielement=e,e.__.node=n,e},Element.prototype.isTab=function(){return null!==this.__.tabContainer},Element.prototype.makeTabFor=function(e){this.__.tabContainer=e,e.hide();let t=this.getAllNearbyElements();this.on("click",tabClickHandler);for(let n=0,r=t.length;n<r;n++)if(t[n].isTab())return this;return this.addClass("active"),e.addClass("active").css({display:"flex",opacity:1}),this},Element.prototype.tabContainer=function(){return this.__.tabContainer},addEventsMethods(Instance.prototype),Instance.prototype.getChannel=function(){return this.__.ui.channel},Instance.prototype.isImplementationOf=function(e){return 0<=this.__.ui.__.implements.indexOf(e)},Instance.prototype.remove=function(){let e=this.__.parent,t=this.__.ui.scheme;for(let e in t)t.hasOwnProperty(e)&&null!==this[e].__.node.parentNode&&this[e].__.node.parentNode.removeChild(this[e].__.node);if(!0==e instanceof Element)for(let t=0,n=e.__.children.length;t<n;t++)if(e.__.children[t]===this){e.__.children.splice(t,1);break}},Instance.prototype.ui=function(){return this.__.ui},Instance.prototype.UI=function(){return this.__.ui},Instance.prototype.loadLocalization=function(e){let t=this.__.ui.localization;null===t?warn("Localization loading failed: localization category is not specified for the UI \""+this.__.ui.name+"\"."):L10n.loadTranslations(t,e)},Instance.prototype.params=function(){return this.__.params},Instance.prototype.parentUII=function(){let e=this.__.parent;return e instanceof Element?e.__.uiinstance:null},Instance.prototype.load=function(e,t,n){if("boolean"!=typeof t&&(t=!0),"boolean"!=typeof n&&(n=!1),e instanceof Data){try{e.fetch(function(t,n,r){this.load(r,t,n),this.triggerEvent("afterLoad",e),this.__.ui.triggerEvent("afterLoad",this,e)}.bind(this,t,n))}catch(t){error(t)}return this}let r=new Event("load",{cancelable:!0});if(this.__.ui.triggerEvent("load",this,e,r),r.defaultPrevented)return this.triggerEvent("afterLoad",e),this.__.ui.triggerEvent("afterLoad",this,e),this;if(r=new Event("load",{cancelable:!0}),this.triggerEvent("load",e,r),r.defaultPrevented)return this.triggerEvent("afterLoad",e),this.__.ui.triggerEvent("afterLoad",this,e),this;let o=this.getRootElement();if("string"==typeof e&&null!==o)return o.load(e,t,n),this.triggerEvent("afterLoad",e),this.__.ui.triggerEvent("afterLoad",this,e),this;if(Array.isArray(e)&&null!==o)return o.load(e,t,n),this.triggerEvent("afterLoad",e),this.__.ui.triggerEvent("afterLoad",this,e),this;for(let r in e)if("__"!=r)if(this.hasOwnProperty(r)){let o=this[r];if(this[r]instanceof Element){let s=o.inclusion();if(!(s instanceof Instance))try{this[r].load(e[r],t,n)}catch(t){error(t)}else if(Array.isArray(e[r])){let d=s.getRootElement();if(null===d||!o.hasChildUI())s.load(e[r],t,n);else try{d.load(e[r],t,n)}catch(t){error(t)}}else s.load(e[r],t,n)}else o.load(e[r],t,n)}else{let t=uiRegistry.get(r);null!==t&&null!==o&&t.renderTo(o,!1,{}).load(e[r],!0,!1)}return this.triggerEvent("afterLoad",e),this.__.ui.triggerEvent("afterLoad",this,e),this},Instance.prototype.getRootElement=function(){let e=Object.keys(this.__.ui.scheme);return 1===e.length&&this.hasOwnProperty(e[0])?this[e[0]]:null},Instance.prototype.getLastRootElement=function(){let e=Object.keys(this.__.ui.scheme),t=e[e.length-1];return 1===e.length&&this.hasOwnProperty(t)?this[t]:null},Instance.prototype.appendTo=function(e){let t=e instanceof Element?e.node():e;if(void 0===t.appendChild)return void error("Invalid argument given for the instance \"appendAfter()\" method: "+typeof e+" given but node or element is required.");let n=this.UI().scheme;for(let r in n)n.hasOwnProperty(r)&&this.hasOwnProperty(r)&&(t.appendChild(this[r].node()),t.element instanceof Element&&(this[r].__.parent=t.element))},Instance.prototype.appendAfter=function(e){let t=e instanceof Element?e.node():e;if(void 0===t.appendChild)return void error("Invalid argument given for the instance \"appendAfter()\" method: "+typeof e+" given but node or element is required.");let n=t.parentNode;if(null===n)return void error("Element given for the method instance \"appendAfter()\" have no parent node.");let r=this.UI().scheme,o=t.nextSibling;if(o)for(let e in r)r.hasOwnProperty(e)&&this.hasOwnProperty(e)&&(n.insertBefore(this[e].node(),o),n.element instanceof Element&&(this[e].__.parent=n.element));else for(let e in r)r.hasOwnProperty(e)&&this.hasOwnProperty(e)&&(n.appendChild(this[e].node()),n.element instanceof Element&&(this[e].__.parent=n.element))},Instance.prototype.appendBefore=function(e){let t=e instanceof Element?e.node():e;if(void 0===t.appendChild)return void error("Invalid argument given for the instance \"appendAfter()\" instance method: "+typeof e+" given but node or element is required.");let n=t.parentNode;if(null===n)return void error("Element given for the method instance \"appendAfter()\" have no parent node.");let r=this.UI().scheme;for(let o in r)r.hasOwnProperty(o)&&this.hasOwnProperty(o)&&(n.insertBefore(this[o].node(),t),n.element instanceof Element&&(this[o].__.parent=n.element))},Instance.prototype.applyExtension=function(e,t){if(this.__.extensions.hasOwnProperty(e))return warn("Extension with name \""+e+"\" is already applied to the instance."),!1;let n=extensionsManager(e);return null===n?(error("Extension with name \""+e+"\" is not registered yet."),!1):(this.__.extensions[e]=n.applyTo(this,t),!0)},Instance.prototype.extension=function(e){return this.__.extensions.hasOwnProperty(e)?this.__.extensions[e]:null},Instance.prototype.removeExtension=function(e){if(!this.__.extensions.hasOwnProperty(e))return!1;let t=this.__.extensions[e];return void 0!==t.remove&&(t.remove(),delete this.__.extensions[e],!0)},Instance.prototype.updateExtension=function(e,t){if(!this.__.extensions.hasOwnProperty(e))return!1;let n=this.__.extensions[e];return void 0!==n.update&&(n.update(t),!0)};let styles={},stylesRegistry={add(e,t){return styles.hasOwnProperty(e)?void error("Styles with namespace "+e+" already exists."):void(styles[e]=t)},get(e){return styles.hasOwnProperty(e)?styles[e]:{}}},cssGenerator={generateUIStyles(e){return"string"==typeof e.css&&(e.css=stylesRegistry.get(e.css)),generateCSS.call(e,e.css)},generateSimpleStyles(e){let t="\n";for(let n in e)if(e.hasOwnProperty(n)){if("object"!=typeof e[n])continue;for(let r in t+=n+" {\n",e[n])if(e[n].hasOwnProperty(r)){let o=e[n][r];void 0!==o.getValue&&(o=o.getValue()),t+="    "+makeClassName(""+r)+": "+o+";\n"}t+="}\n"}return t}};class Interface$1{constructor(e,t){this.name=e,this.methods={},this.methodsQuantity=0;for(let n=0,r=t.length,o;n<r;n++)o=new Method(t[n]),o.valid&&(this.methods[o.name]=o,this.methodsQuantity++)}implementedBy(e){for(let t in this.methods)if(this.methods.hasOwnProperty(t)&&("function"!=typeof e[t]||!this.methods[t].checkSignature(e[t])))return!1;return!0}toString(){let e=this.name+" {\n";for(let t in this.methods)this.methods.hasOwnProperty(t)&&(e+="    "+t+"("+this.methods[t].arguments.join(", ")+")\n");return e+"}"}}let signatureRegexp=/^([\w$_]+[$\w\d]*)\s*\(([\w\d\s,$]*)\)/i;class Method{constructor(e){this.valid=!0;let t=(e+"").match(signatureRegexp);if(null===t||2>t.length)return error("Invalid method signature."),void(this.valid=!1);if(this.name=t[1],2<t.length){this.arguments=t[2].split(",");for(let e=0,t=this.arguments.length;e<t;e++)this.arguments[e]=this.arguments[e].trim(),""===this.arguments[e]&&this.arguments.splice(e,1)}}checkSignature(e){let t=(e+"").match(signatureRegexp);if(null===t||2>t.length)return!1;if(0<this.arguments.length){if(3>t.length)return!1;let e=t[2].split(",");if(""===t[2]||this.arguments.length>e.length)return!1}return!0}}let interfaces={},interfacesUIs={};addEventsMethods(interfaceManager),interfaceManager.getImplementation=function(e){return interfacesUIs.hasOwnProperty(e)&&0<interfacesUIs[e].length?interfacesUIs[e][0]:null},interfaceManager.addImplementation=function(e,t){interfacesUIs.hasOwnProperty(e)||(interfacesUIs[e]=[]),0>interfacesUIs[e].indexOf(t)&&interfacesUIs[e].push(t)},interfaceManager.register=function(e,t){return e=e.trim(),"string"!=typeof e||""===e?void error("Interface name is invalid."):Array.isArray(t)&&0!==t.length?interfaces.hasOwnProperty(e)?void warn("Interface with name \""+e+"\" is already registered."):void(interfaces[e]=new Interface$1(e,t),Settings.devMode&&interfaceManager.triggerEvent("register",interfaces[e])):void error("Interface method must contain at least one method signature.")},interfaceManager.detectInterfacesFor=function(e){let t=[];for(let n in interfaces)interfaces.hasOwnProperty(n)&&interfaces[n].implementedBy(e)&&t.push(interfaces[n].name);return t};let uis=uiRegistry.getAll();interfaceManager.on("register",e=>{let t=[];for(let n in uis)uis.hasOwnProperty(n)&&e.implementedBy(uis[n].uiiConstructor.prototype)&&(uis[n].__.implements.push(e.name),t.push(uis[n]));interfacesUIs[e.name]=t});class UIExtending{constructor(e,t,n){this.extendingUI=e,this.extendedUIName=t,this.options=n}extend(){let e=uiRegistry.get(this.extendedUIName);if(null===e)throw new UIRegistrationException("UI which be extended is not found.");let t=this.extendingUI,n=this.options;for(let r in n.hasOwnProperty("scheme")||(n.scheme={}),n.hasOwnProperty("rules")||(n.rules={}),n.hasOwnProperty("styles")||(n.styles={}),n.hasOwnProperty("translations")||(n.translations={}),n.hasOwnProperty("params")||(n.params={}),t.uiiConstructor=e.uiiConstructor,t.elements={},t.scheme=extendObject(n.scheme,cloneSimpleObject(e.scheme)),t.rules=extendObject(n.rules,cloneSimpleObject(e.rules)),t.translations=extendObject(n.translations,cloneSimpleObject(e.translations)),t.css=extendObject(n.styles,cloneSimpleObject(e.css)),t.params=extendObject(n.params,cloneSimpleObject(e.params)),t.localization=n.hasOwnProperty("localization")?n.localization:e.localization,t.cssLoaded=!1,t.__.events=cloneSimpleObject(e.__.events),t.__.styleNode=null,t.__.data=n.hasOwnProperty("data")?n.data:null,t.__.url=null,t.uiiConstructor=n.hasOwnProperty("methods")?function(){function r(e){Instance.call(this,e)}for(let t in r.prototype=Object.create(e.uiiConstructor.prototype),r.prototype.constructor=Instance,n.methods)n.methods.hasOwnProperty(t)&&"function"==typeof n.methods[t]&&!Instance.prototype.hasOwnProperty(t)&&(r.prototype[t]=n.methods[t]);return t.__.implements=interfaceManager.detectInterfacesFor(n.methods),r}():e.uiiConstructor,n.hasOwnProperty("parameters")?t.__.params=extendObject(n.parameters,cloneSimpleObject(e.__.params)):n.hasOwnProperty("params")&&(t.__.params=extendObject(n.params,cloneSimpleObject(e.__.params))),cloneSchemeLinear(t.scheme,t.elements),t.elements)t.elements.hasOwnProperty(r)&&t.rules.hasOwnProperty(r)&&""===t.elements[r].rules&&(t.elements[r].rules=t.rules[r]);for(let e in n)n.hasOwnProperty(e)&&"on"===e.slice(0,2)&&"function"==typeof n[e]&&t.addEventListener(e.slice(2),n[e]);return t}}let namespaces={};class Namespace{constructor(e){namespaces.hasOwnProperty(e)&&error("Namespace \""+e+"\" already exists."),this.name=e,this.channel={},addEventsMethods(this.channel),namespaces[e]=this}}Namespace.exists=function(e){return namespaces.hasOwnProperty(e)},Namespace.getOrCreate=function(e){return namespaces.hasOwnProperty(e)?namespaces[e]:new Namespace(e)};class UI$1{constructor(e){if("object"!=typeof e&&(e={}),this.namespace=e.namespace||null,null===this.namespace?(this.channel={},addEventsMethods(this.channel)):this.channel=Namespace.getOrCreate(e.namespace).channel,this.elements={},this.scheme=e.hasOwnProperty("scheme")?e.scheme:{},this.rules=e.hasOwnProperty("rules")?e.rules:{},this.prefix=e.hasOwnProperty("prefix")?e.prefix:"",this.name=e.hasOwnProperty("name")?e.name:"",this.css=e.hasOwnProperty("css")?e.css:null,this.dependencies={},this.localization=e.hasOwnProperty("localization")?e.localization:null,this.translations=e.hasOwnProperty("translations")?e.translations:{},this.css=e.css||e.styles||{},this.cssLoaded=!1,"object"!=typeof this.scheme)throw new InvalidSchemeException("Scheme must be an object. "+typeof this.scheme+" given.");if(this.__={},this.__.dispatchers={},this.__.events={},this.__.eventsTimeouts={},this.__.implements=[],this.__.styleNode=null,this.__.data=e.hasOwnProperty("data")?e.data:null,this.__.url=null,this.__.params=e.params||e.parameters||{},e.hasOwnProperty("methods")){this.__.implements=interfaceManager.detectInterfacesFor(e.methods);for(let e=0;e<this.__.implements.length;e++)interfaceManager.addImplementation(this.__.implements[e],this);this.uiiConstructor=function(){function t(e){Instance.call(this,e)}for(let n in t.prototype=Object.create(Instance.prototype),t.prototype.constructor=Instance,e.methods)e.methods.hasOwnProperty(n)&&("function"!=typeof e.methods[n]||Instance.prototype.hasOwnProperty(n)||(t.prototype[n]=e.methods[n]));return t}()}else this.uiiConstructor=Instance;if(cloneSchemeLinear(this.scheme,this.elements),e.hasOwnProperty("dependencies")){let t=e.dependencies;for(let e in t)if(this.elements.hasOwnProperty(e))if(Array.isArray(t[e]))this.dependencies[e]=t[e];else if("string"==typeof t[e]){let n=t[e].split(",");for(let e=0,t=n.length;e<t;e++)n[e]=n[e].trim();this.dependencies[e]=n}}for(let t in this.elements)this.elements.hasOwnProperty(t)&&this.rules.hasOwnProperty(t)&&""===this.elements[t].rules&&(this.elements[t].rules=this.rules[t]);for(let t in e)e.hasOwnProperty(t)&&"on"===t.slice(0,2)&&"function"==typeof e[t]&&this.addEventListener(t.slice(2),e[t])}removeFrom(e){"string"==typeof e&&(e=document.querySelector(e)),e instanceof Element&&(e=e.node());let t=e.childNodes;for(let n=0;n<t.length;n++)if(t[n].instance instanceof Instance&&t[n].instance.UI()===this){let e=new Event("remove",{cancelable:!0});t[n].instance.triggerEvent("remove",e),e.defaultPrevented||t[n].instance.remove()}}isImplementationOf(e){return 0<=this.__.implements.indexOf(e)}getRootElement(){let e=Object.keys(this.scheme);return 1===e.length?this.elements[e[0]]:null}prepare(e){e=cloneSimpleObject(e);let t=new this.uiiConstructor;t.__.ui=this;let n={container:null,atStart:!1,params:e,localization:this.localization,translations:Object.assign({},this.translations)};this.triggerEvent("prepare",t,n),e=n.params,t.__.localization=n.localization,t.__.translations=n.translations;try{buildScheme(t,this,this.scheme,null)}catch(t){error(t)}for(let t in"object"!=typeof e&&(e={}),e)e.hasOwnProperty(t)&&(e[t]=filterUIParameterValue(e[t]));for(let t in this.__.params)this.__.params.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=this.__.params[t]);t.__.params=e;let r=new Event("create",{cancelable:!0});return this.triggerEvent("create",t,e,r),t}renderTo(e,t,n){"object"==typeof t&&"object"!=typeof n&&(n=t);let r=this.prepare(n);n=r.__.params;let o={container:e,atStart:t,params:r.__.params,localization:this.localization,translations:Object.assign({},this.translations)};this.triggerEvent("beforeRender",o),e=o.container,t=o.atStart,r.__.localization=o.localization,r.__.translations=o.translations;let s=e;e instanceof Element?(r.__.parent=e,e.__.children.push(r),s=e.node()):"string"==typeof e&&(s=document.querySelector(e)),this.cssLoaded||null===this.css||this.createStyles(),t=!0===t;let d=this.scheme;for(let o in d)d.hasOwnProperty(o)&&(t&&0!==s.childNodes.length?s.insertBefore(r[o].node(),s.childNodes[0]):s.appendChild(r[o].node()),e instanceof Element&&(r[o].__.parent=e));for(let r in"object"!=typeof n&&(n={}),n)n.hasOwnProperty(r)&&(n[r]=filterUIParameterValue(n[r]));for(let r in this.__.params)!n.hasOwnProperty(r)&&this.__.params.hasOwnProperty(r)&&(n[r]=this.__.params[r]);return this.triggerEvent("render",r,n),r}render(e){return this.renderTo("body",e)}createStyles(){this.cssLoaded=!0;let e=cssGenerator.generateUIStyles(this);if(""===e)return;let t=document.getElementsByTagName("head")[0],n=document.createElement("style");n.setAttribute("data-ui",this.name),n.ui=this,n.innerHTML=e,t.appendChild(n)}}addEventsMethods(UI$1.prototype),UI$1.prototype.extends=function(e,t){let n=new UIExtending(this,e,t);uiRegistry.remove(this.name),extendingsRegistry.add(this.name,n)};let resetStyles={};addEventsMethods(Builder),Builder.register=function(e){"string"==typeof e&&(e={name:e}),checkUIParameters(e);let t=new UI$1(e);return uiRegistry.add(e.name,t),Builder.triggerEvent("register",t),t},Builder.isInstance=function(e){return e instanceof Instance},Builder.isElement=function(e){return e instanceof Element},Builder.createResetStyles=createResetStyles;let layouts={},currentLayoutName=null,currentLayoutInst=null;addEventsMethods(Layout),Layout.register=function(e){return checkUIParameters(e),null!==uiRegistry.get(e.name)&&error("UI with name \""+e.name+"\" already registered."),layouts[e.name]=new UI$1(e),Layout.triggerEvent("register",layouts[e.name]),layouts[e.name]},Layout.render=function(e,t){let n=getLayout(e);return null===n&&error("Layout with name \""+e+"\" is not registered yet."),currentLayoutInst=n.render(t),currentLayoutName=e,currentLayoutInst},Layout.getInstance=function(){return currentLayoutInst};class LayoutUI{constructor(e){this.name=e}render(e){let t=getLayout(this.name);return currentLayoutInst=t.render(e),currentLayoutName=this.name,currentLayoutInst}}Color$1.prototype={toRgbString:function(){return"rgb("+this.red+", "+this.green+", "+this.blue+")"},toRgbaString:function(e){return void 0===e&&(e=this.opacity),"rgba("+this.red+", "+this.green+", "+this.blue+", "+e+")"},toHwbString:function(){return"hwb("+this.hue+", "+_Mathround(100*this.whiteness)+"%, "+_Mathround(100*this.blackness)+"%)"},toHwbStringDecimal:function(){return"hwb("+this.hue+", "+this.whiteness+", "+this.blackness+")"},toHwbaString:function(){return"hwba("+this.hue+", "+_Mathround(100*this.whiteness)+"%, "+_Mathround(100*this.blackness)+"%, "+this.opacity+")"},toHslString:function(){return"hsl("+this.hue+", "+_Mathround(100*this.sat)+"%, "+_Mathround(100*this.lightness)+"%)"},toHslStringDecimal:function(){return"hsl("+this.hue+", "+this.sat+", "+this.lightness+")"},toHslaString:function(){return"hsla("+this.hue+", "+_Mathround(100*this.sat)+"%, "+_Mathround(100*this.lightness)+"%, "+this.opacity+")"},toCmykString:function(){return"cmyk("+_Mathround(100*this.cyan)+"%, "+_Mathround(100*this.magenta)+"%, "+_Mathround(100*this.yellow)+"%, "+_Mathround(100*this.black)+"%)"},toCmykStringDecimal:function(){return"cmyk("+this.cyan+", "+this.magenta+", "+this.yellow+", "+this.black+")"},toNcolString:function(){return this.ncol+", "+_Mathround(100*this.whiteness)+"%, "+_Mathround(100*this.blackness)+"%"},toNcolStringDecimal:function(){return this.ncol+", "+this.whiteness+", "+this.blackness},toNcolaString:function(){return this.ncol+", "+_Mathround(100*this.whiteness)+"%, "+_Mathround(100*this.blackness)+"%, "+this.opacity},toName:function(){let e=getColorArr("hexs"),t,n,o;for(i=0;i<e.length;i++)if(t=parseInt(e[i].substr(0,2),16),n=parseInt(e[i].substr(2,2),16),o=parseInt(e[i].substr(4,2),16),this.red===t&&this.green===n&&this.blue===o)return getColorArr("names")[i];return""},toHexString:function(){let e=toHex(this.red),t=toHex(this.green),n=toHex(this.blue);return"#"+e+t+n},toRgb:function(){return{r:this.red,g:this.green,b:this.blue,a:this.opacity}},toHsl:function(){return{h:this.hue,s:this.sat,l:this.lightness,a:this.opacity}},toHwb:function(){return{h:this.hue,w:this.whiteness,b:this.blackness,a:this.opacity}},toCmyk:function(){return{c:this.cyan,m:this.magenta,y:this.yellow,k:this.black,a:this.opacity}},toNcol:function(){return{ncol:this.ncol,w:this.whiteness,b:this.blackness,a:this.opacity}},isDark:function(e){return(299*this.red+587*this.green+114*this.blue)/1e3<(e||128)},saturate:function(e){let t,n,r;return t=e/100||.1,this.sat+=t,1<this.sat&&(this.sat=1),n=hslToRgb(this.hue,this.sat,this.lightness),r=colorObject(n,this.opacity,this.hue,this.sat),this.attachValues(r),this},desaturate:function(e){let t,n,r;return t=e/100||.1,this.sat-=t,0>this.sat&&(this.sat=0),n=hslToRgb(this.hue,this.sat,this.lightness),r=colorObject(n,this.opacity,this.hue,this.sat),this.attachValues(r),this},lighter:function(e){let t,n,r;return t=e/100||.1,this.lightness+=t,1<this.lightness&&(this.lightness=1),n=hslToRgb(this.hue,this.sat,this.lightness),r=colorObject(n,this.opacity,this.hue,this.sat),this.attachValues(r),this},darker:function(e){let t,n,r;return t=e/100||.1,this.lightness-=t,0>this.lightness&&(this.lightness=0),n=hslToRgb(this.hue,this.sat,this.lightness),r=colorObject(n,this.opacity,this.hue,this.sat),this.attachValues(r),this},attachValues:function(e){this.red=e.red,this.green=e.green,this.blue=e.blue,this.hue=e.hue,this.sat=e.sat,this.lightness=e.lightness,this.whiteness=e.whiteness,this.blackness=e.blackness,this.cyan=e.cyan,this.magenta=e.magenta,this.yellow=e.yellow,this.black=e.black,this.ncol=e.ncol,this.opacity=e.opacity,this.valid=e.valid}};class StyleGetter{constructor(e){this.name=e,this._darker=0,this._lighter=0,this._alpha=void 0,this._default="initial"}getValue(){let e=Theme.getStyle(this.name);if(e instanceof Color){let t=new Color(e.toRgbaString());0<this._darker&&t.darker(this._darker),0<this._lighter&&t.lighter(this._lighter),e=t.toRgbaString(this._alpha)}return null===e?this._default:e}alpha(e){return this._alpha=e,this}darker(e){return this._darker+=e,this}lighter(e){return this._lighter+=e,this}}StyleGetter.prototype.default=function(e){return this._default=e,this},XY.prototype.add=function(e,t){return"object"==typeof e&&(e.hasOwnProperty("y")&&(t=e.y),e=e.x),this.x+=e,this.y+=t,this},XY.prototype.subtract=function(e,t){return"object"==typeof e&&(e.hasOwnProperty("y")&&(t=e.y),e=e.x),this.x-=e,this.y-=t,this},XY.prototype.multiply=function(e,t){return"object"==typeof e?(e.hasOwnProperty("y")&&(t=e.y),e.hasOwnProperty("x")&&(e=e.x)):void 0===t&&(t=e),this.x*=e,this.y*=t,this},XY.prototype.divide=function(e,t){return"object"==typeof e?(e.hasOwnProperty("y")&&(t=e.y),e.hasOwnProperty("x")&&(e=e.x)):void 0===t&&(t=e),this.x/=e,this.y/=t,this},Point$1.prototype=Object.create(XY.prototype),Point$1.prototype.constructor=Point$1,Point$1.prototype.inRect=function(e){return this.x>=e.x&&this.x<=e.x+e.w&&this.y>=e.y&&this.y<=e.y+e.h},Rect.prototype=Object.create(Point$1.prototype),Rect.prototype.constructor=Rect,Rect.prototype.multiply=function(e){return this.x*=e.x,this.y*=e.y,this.w*=e.w,this.h*=e.h,this},Rect.prototype.fit=function(e){let t=this.w/this.h,n=e.w/e.h;return t>=n?(this.h*=e.w/this.w,this.w=e.w):(this.w*=e.h/this.h,this.h=e.h),this},Rect.prototype.copyValuesFrom=function(e){this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h},Vector.prototype=Object.create(Point$1.prototype),Vector.prototype.constructor=Vector,Vector.prototype.normalize=function(){let e=_Mathsqrt(this.x*this.x+this.y*this.y);return this.x=x/e,this.y=y/e,this};let themes={},currentTheme=null;addEventsMethods(themesManager),themesManager.register=function(e,t,n){return(n=!1!==n,!themes.hasOwnProperty(e))?(themes[e]=new Theme$1(e,t),themesManager.triggerEvent("register",e),!0):n?(themes[e].updateStyles(t),Settings.logging&&log("Theme \""+e+"\" has been updated."),!0):(warn("Theme with name \""+e+"\" is already registered."),!1)},themesManager.switchTo=function(e){if(!themes.hasOwnProperty(e))return warn("Theme can't be switched because theme \""+e+"\" is not registered."),!1;currentTheme=themes[e];let t=document.getElementsByTagName("style");for(let n=0,r=t.length;n<r;n++)if(t[n].hasOwnProperty("ui")){let e=t[n].ui;t[n].innerHTML=cssGenerator.generateUIStyles(e)}return this.triggerEvent("switch"),!0},themesManager.getStyle=function(e){if(null===currentTheme)return warn("Theme is not selected"),null;let t=e.split("."),n=t.pop();if(0===t.length)return currentTheme.getStyle(n);let r=currentTheme;do{let o=t.shift();if(!r.components.hasOwnProperty(o))return Settings.devMode&&warn("Style with name \""+e+"\" is absent in the current theme \""+currentTheme.name+"\"."),null;r=r.components[o]}while(0<t.length);return r.getStyle(n)},themesManager.getThemeName=function(){return null===currentTheme?(warn("Theme is not selected"),null):currentTheme.name},themesManager.addSection=function(e,t){return null===currentTheme?(warn("Theme is not selected"),!1):currentTheme.components.hasOwnProperty(e)?(warn("Component \""+e+"\" already exists in the theme \""+currentTheme.name+"\"."),!1):(currentTheme.components[e]=new Theme$1(e,t),!0)};class Theme$1{constructor(e,t){if(this.name=e,this.styles={},this.components={},"object"==typeof t)for(let e in t)t.hasOwnProperty(e)&&("object"!=typeof t[e]||t[e]instanceof Color$1?this.styles[e]=t[e]:this.components[e]=new Theme$1(e,t[e]))}getStyle(e){return this.styles.hasOwnProperty(e)?this.styles[e]:(warn("Style with name \""+e+"\" is absent in the current theme \""+themesManager.getThemeName()+"\"."),null)}updateStyles(e){for(let t in e)e.hasOwnProperty(t)&&("object"!=typeof e[t]||e[t]instanceof Color$1?this.styles[t]=e[t]:this.components.hasOwnProperty(t)?this.components[t].updateStyles(e[t]):this.components[t]=new Theme$1(t,e[t]))}}let csrfParam="csrf",csrfToken=null,urlRefiners={},urlParsers={};Url.setRefiner=function(e,t){"function"==typeof t&&(urlRefiners[e]=t)},Url.setParser=function(e,t){"function"==typeof t&&(urlParsers[e]=t)},Url.parse=function(e){let t=e.match(/\?(&?[\w\d-_%]+=[\w\d-_%]*)+/gi),n=null!==t&&0<t.length?t[0]:"";e=e.replace(n,"").replace(window.location.origin,""),"?"===n[0]&&(n=n.slice(1));let r={},o=n.split("&");for(let t=0,n;t<o.length;t++)n=o[t].split("="),1<n.length&&(r[n[0]]=n[1]);for(let t in urlParsers){let n=urlParsers[t](e,r);e=n.url,r=n.params}return{route:e,params:r}},URL.prototype.gatherParams=function(e){let t=$(e);if(0===t.length)return this;let n=this;return t.find("input").each(function(){let e=$(this).attr("name");"string"==typeof e&&0<e.length&&(n.params[e]=this.value)}),t.find("select").each(function(){let e=$(this).attr("name");"string"==typeof e&&0<e.length&&(n.params[e]=this.value)}),t.find("textarea").each(function(){let e=$(this).attr("name");"string"==typeof e&&0<e.length&&(n.params[e]=this.value)}),this},URL.prototype.toString=function(){let e=[];for(let t in this.params)this.params.hasOwnProperty(t)&&e.push(encodeURIComponent(t)+"="+encodeURIComponent(this.params[t]));return this.path+(0===e.length?"":"?"+e.join("&"))},URL.prototype.removeParams=function(){for(let e=0;e<arguments.length;e++)delete this.params[arguments[e]]};let routes={},curRoute=null,curRouteParams=null,prevRoute=null;addEventsMethods(RouteManager),RouteManager.register=function(e){return routes[e]=new Route(e),routes[e]},RouteManager.current=function(){return curRoute.clone()},RouteManager.previous=function(){return prevRoute},RouteManager.currentParams=function(){return curRouteParams},RouteManager.apply=function(e,t){let n=Url.parse(e);e=n.route;let r=n.params;for(let n in r)r.hasOwnProperty(n)&&(t[n]=r[n]);for(let n in t)0<=e.indexOf("{"+n+"}")&&(e.replace("{"+n+"}",encodeURIComponent(t[n])),delete t[n]);let o=RouteManager(e);return null!==o&&(o.apply(t),!0)},RouteManager.applyChain=function(e){0<e.length&&"/"===e[0]&&(e=e.slice(1));let t=Url.parse(e),n=t.route.split("/"),r=t.params,o;for(let t=0;t<n.length;t++){if(o=RouteManager(n.slice(0,t+1).join("/")),null===o)return void warn("Routes chain broken: route \""+n.slice(0,t).join("/")+"\" is absent.");o.apply(r)}},Route.prototype={constructor:Route,clone:function(){let e=new Route(this.route);return e.params=this.params,e.__=this.__,e},apply:function(e){(void 0===e||null===e)&&(e=this.params),this.params=e;let t=new Event("apply",{cancelable:!0});if(void 0===e&&(e={}),RouteManager.triggerEvent("apply",this.route,e,t),t.defaultPrevented)return!1;if(this.triggerEvent("apply",e,t),t.defaultPrevented)return!1;let n=Url.parse(window.location.pathname),r=n.route.split("/");1<r.length&&""===r[0]&&r.shift();let o=this.route.split("/");for(let t=0;t<o.length;t++)r.length>t&&("??"===o[t]?o[t]=r.slice(0,t+1).join("/"):"?"===o[t]&&(o[t]=r[t]));if(history.pushState(e,"",Url("/"+o.join("/"),e).replace("//","")),prevRoute=curRoute,curRoute=this,curRouteParams=e,prevRoute instanceof Route){if(t=new Event("leave",{cancelable:!0}),RouteManager.triggerEvent("leave",prevRoute.route,curRoute.route,t),t.defaultPrevented)return!0;prevRoute.triggerEvent("leave",prevRoute.route,curRoute.route,t)}return!0},runParentRoute:function(e){let t=this.route.split("/");if(2>t.length)return!1;t.pop();let n=t.join("/"),r=RouteManager(n);if(null!==r){let t=new Event("apply",{cancelable:!0});if(r.triggerEvent("apply",e,t),!t.defaultPrevented)return r.apply(),!0}return!1},revert:function(){}},addEventsMethods(Route.prototype),curRoute=RouteManager.register("/");let language="en";L10n$1.setLanguage=function(e){switchLanguageTo(e)},L10n$1.switchLanguageTo=L10n$1.setLanguage,L10n$1.getLanguage=function(){return language};let translations={en:{},ru:{},es:{},de:{},pt:{},br:{},it:{},fr:{},jp:{},ko:{},zh:{},ua:{}},translators={en:{},ru:{},es:{},de:{},pt:{},br:{},it:{},fr:{},jp:{},ko:{},zh:{},ua:{}},curTranslation=translations.en;addEventsMethods(L10n$1),L10n$1.addTranslation=function(e,t){if(!translations.hasOwnProperty(e)&&"object"==typeof t)for(let n in translations)t.hasOwnProperty(n)&&(translations[n][e]=t[n])};let translationsLoader=defaultTranslationsLoader,localizationsPath="/localizations";L10n$1.setLocalizationsPath=function(e){localizationsPath=e},L10n$1.getLocalizationsPath=function(){return localizationsPath};let currentlyLoading={},translationsLoadingCallbacks={};L10n$1.on("categoryLoaded",function(e,t){if(translationsLoadingCallbacks.hasOwnProperty(t)){let n=translationsLoadingCallbacks[t];for(let t=0;t<n.length;t++)"function"==typeof n[t]&&n[t](e)}delete translationsLoadingCallbacks[t]}),L10n$1.loadTranslations=function(e,n){if(e=e.replace("\\","/"),"/"===e[0]&&(e=e.slice(1)),!0===currentlyLoading[e])return translationsLoadingCallbacks.hasOwnProperty(e)||(translationsLoadingCallbacks[e]=[]),"function"==typeof n&&translationsLoadingCallbacks[e].push(n),!0;if(null===translationsLoader)return warn("Translations loader is not specified."),!1;if(curTranslation.hasOwnProperty(e)){if("function"==typeof n){let r=L10n$1.getTranslations(e);n(r)}return!0}currentlyLoading[e]=!0;let r=setTimeout(function(){delete currentlyLoading[e]},1e4);return translationsLoader(e,function(){delete currentlyLoading[e],clearTimeout(r);let o=L10n$1.getTranslations(e);if(translationsLoadingCallbacks.hasOwnProperty(e)&&Array.isArray(translationsLoadingCallbacks[e])){for(let t=0;t<translationsLoadingCallbacks[e].length;t++)translationsLoadingCallbacks[e][t](o);delete translationsLoadingCallbacks[e]}L10n$1.triggerEvent("categoryLoaded",o,e),"function"==typeof n&&n(o)}),!0},L10n$1.registerTranslationsLoader=function(e){"function"==typeof e&&(null===translationsLoader||translationsLoader===defaultTranslationsLoader)&&(translationsLoader=e)},L10n$1.getTranslations=function(e){function n(e,t){for(let n in r.hasOwnProperty(e)&&(e=r[e]),t)t.hasOwnProperty(n)&&(e=e.replace("{"+n+"}",t[n]));return e}if(translators.hasOwnProperty(language)||(translators[language]={}),translators[language].hasOwnProperty(e))return translators[language][e];let r=curTranslation;return r.hasOwnProperty(e)&&(r=r[e]),n.getAll=function(){return r},r!==curTranslation&&(translators[language][e]=n),n},L10n$1.on("langChange",updateTranslations),L10n$1.on("translations",updateTranslationsByCategory),addEventsMethods(GlobalEvents);class Ajax$1 extends Data{constructor(e){super(e),this.useCsrf=!e.hasOwnProperty("useCsrf")||e.useCsrf,this.url=e.hasOwnProperty("url")?e.url:"",this.method=e.method||"POST",this.collector=ajaxCollector,this.headers=e.headers||{"X-Requested-With":"XMLHttpRequest"},this.hasError=!1}triggerErrorEvents(e){this.hasError=!0;let t=new Event("error",{cancelable:!0});return this.triggerEvent("error",e,t),Ajax$1.triggerEvent("error",this,e,t),t}triggerRedirectionEvents(e,t){let n=new Event("redirect",{cancelable:!0});return this.triggerEvent("redirect",e,t,n),Ajax$1.triggerEvent("redirect",this,e,t,n),n}}addEventsMethods(Ajax$1);let permanentRedirections={};class WSData extends Data{constructor(e){super(e),this.ws=e.ws,this.collector=UIWebSocketCollector}}addEventsMethods(WSData),WS.FORMAT_JSON="json",WS.FORMAT_TOKENIZED_JSON="tokenized-json",WS.FORMAT_RAW="text",WS.prototype={},addEventsMethods(WS.prototype),WS.prototype.connect=function(){if(null!==this.conn)return;let e=new WebSocket(this.url);this.conn=e;let t=this,n;e.onopen=function(){null!==t.authRequestMessage&&t.conn.send(t.authRequestMessage),clearInterval(n),t.triggerEvent("connect")},e.onclose=function(){t.authorized=!1,t.conn=null,t.tokens={},n=setTimeout(function(){t.connect()},t.reconnectionInterval),t.triggerEvent("disconnect")},e.onerror=function(t){error("WS connection error.",t)},e.onmessage=function(n){if(null!==t.authRequestMessage){if(n.data===t.authSuccessMessage)return t.authorized=!0,void t.triggerEvent("authSuccess");if(n.data===t.authFailMessage)return t.authorized=!1,void t.triggerEvent("authFail")}if(t.format===WS.FORMAT_RAW)t.triggerEvent("message",n.data);else if(t.format===WS.FORMAT_JSON)t.triggerEvent("message",JSON.parse(n.data));else if(t.format===WS.FORMAT_TOKENIZED_JSON){let e=JSON.parse(n.data);if(!e.hasOwnProperty("Token"))return void t.triggerEvent("message",e);let r=e.Token;if(delete e.Token,!t.tokens.hasOwnProperty(r))return;e.hasOwnProperty("Data")&&(e=e.Data),t.triggerEvent("message",e),t.triggerEvent("response",e),t.tokens[r](e),delete t.tokens[r]}}},WS.prototype.send=function(e,t){if(null!==this.conn){let n=new Message(e);this.tokens[n.token]=t;let r={data:n};this.triggerEvent("beforeSend",r),this.conn.send(JSON.stringify(r.data)),this.triggerEvent("send",r.data)}};let isAdded=Symbol("isAdded");class Storage extends Data{constructor(e,t){t===void 0&&(t={}),super(t),this.throttle=t.throttle||0,this.entityClass=e,addEventsMethods(this.entityClass.prototype),this.entities=[]}add(e,t){return e instanceof this.entityClass||(e=this.createEntity(e)),!!(0>this.entities.indexOf(e)&&!1===e[isAdded])&&(e[isAdded]=!0,this.entities.push(e),!1!==t&&(this.triggerEvent("add ~"+this.throttle,e),this.triggerEvent("change ~"+this.throttle,e)),!0)}addMultiple(e,t){let n=0;for(let r=0;r<e.length;r++)this.add(e[r],!1)&&n++;return!1!==t&&(this.triggerEvent("add ~"+this.throttle,null),this.triggerEvent("change ~"+this.throttle,null)),n}remove(e,t){let n=this.entities.indexOf(e);return!!(0<=n)&&(e[isAdded]=!1,this.entities.splice(n,1),!1!==t&&(this.triggerEvent("remove",e),this.triggerEvent("change ~"+this.throttle)),!0)}removeAll(e){for(let t=0;t<this.entities.length;t++)this.entities[t][isAdded]=!1;return this.entities=[],!1!==e&&this.triggerEvent("change ~"+this.throttle),this}count(){return this.entities.length}length(){return this.entities.length}createEntity(e){let t=new this.entityClass(e),n={},r=this;for(let o in t)t.hasOwnProperty(o)&&o!==isAdded&&(n[o]=t[o],delete t[o],Object.defineProperty(t,o,{enumerable:!0,set:function(e){n[o]=e,t[isAdded]&&r.triggerEvent("change ~"+r.throttle,t)},get:function(){return n[o]}}));return Object.defineProperty(t,isAdded,{enumerable:!1,set:function(e){n[isAdded]=!0===e},get:function(){return n[isAdded]}}),t[isAdded]=!1,t}set onChange(e){this.on("change",e)}set onAdd(e){this.on("add",e)}set onRemove(e){this.on("remove",e)}}addEventsMethods(Storage.prototype),Storage.isEntityAdded=function(e){return!0===e[isAdded]};let currentUser=null;addEventsMethods(Identity),Identity.isGuest=function(){return null===currentUser},Identity.getUser=function(){return currentUser},User.prototype={constructor:User,fullName:function(){return this.firstName+" "+this.secondName}},Identity.changeUser=function(e){let t=new User(e);Identity.triggerEvent("changeUser",currentUser,t),currentUser=t},Format.ordinal=function(e){e=parseFloat(e);return 11<=e%100&&13>=e%100?e+"th":e+["th","st","nd","rd","th","th","th","th","th","th"][e%10]},Format.monthShortName=function(e,t){t===void 0&&(t=L10n$1.getLanguage());return{en:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ru:["\u042F\u043D\u0432.","\u0424\u0435\u0432.","\u041C\u0430\u0440.","\u0410\u043F\u0440.","\u041C\u0430\u0439","\u0418\u044E\u043D.","\u0418\u044E\u043B.","\u0410\u0432\u0433.","\u0421\u0435\u043D.","\u041E\u043A\u0442.","\u041D\u043E\u044F.","\u0414\u0435\u043A."]}[t][e]},Format.date=function(e,t){return void 0===t&&(t="d m Y"),formatDate(e,t)},Format.time=function(e,t){return Format.date(e,t===void 0?"H:i":t)},Format.money=function(e,t){return null===e?"":(("EUR"===t?"\u20AC":"$")+" "+parseFloat(e)).replace(",",".")};let channels={};EventsChannel.prototype={},addEventsMethods(EventsChannel.prototype),Builder.error=error,Builder.warn=warn,Builder.log=log,Builder.Theme=themesManager,Builder.Extension=extensionsManager,Builder.L10n=L10n$1,Builder.setLanguage=L10n$1.setLanguage,Builder.getLanguage=L10n$1.getLanguage,Builder.Identity=Identity,Builder.Format=Format,Builder.Interface=interfaceManager,Builder.Data=Data,Builder.Ajax=Ajax$1,Builder.DataWS=WSData,Builder.WSData=WSData,Builder.WS=WS,Builder.XY=XY,Builder.Point=Point$1,Builder.Vector=Vector,Builder.Rect=Rect,Builder.Storage=Storage,Builder.setCsrfToken=setCsrfToken,Builder.layout=Layout,Builder.Url=Url,Builder.Route=RouteManager,Builder.GlobalEvents=GlobalEvents,Builder.Animation=Animation$1,Builder.EventsChannel=channelsManager,Builder.inDevMode=function(){return Settings.devMode},Builder.enableDevMode=function(e){Settings.devMode=!1!==e},Builder.enableLogging=function(e){Settings.logging=!1!==e},Builder.loggingEnabled=function(){return Settings.logging},window.UI=Builder,window.Extension=extensionsManager,window.L10n=L10n$1,window.Layout=Layout,window.Interface=interfaceManager,window.Animation=Animation$1,window.GlobalEvents=GlobalEvents,window.EventsChannel=channelsManager,window.Animation=Animation$1,window.Data=Data,window.DataAjax=Ajax$1,window.Ajax=Ajax$1,window.DataWS=WSData,window.WS=WS,window.Storage=Storage,window.Color=Color$1,window.StyleGetter=StyleGetter,window.Theme=themesManager,window.Point=Point$1,window.Rect=Rect,window.Vector=Vector,window.Identity=Identity,window.Format=Format,window.Route=RouteManager,window.Url=Url,window.URL=URL,window.UI.mouseX=0,window.UI.mouseY=0,window.UI.isTabletScreen=function(){return 640<=document.body.clientWidth&&1024>document.body.clientWidth},window.UI.isPhoneScreen=function(){return 240<document.body.clientWidth&&640>document.body.clientWidth},document.addEventListener("mousemove",function(t){window.UI.mouseX=t.touches===void 0?t.clientX:t.touches[0].clientX,window.UI.mouseY=t.touches===void 0?t.clientY:t.touches[0].clientY}),registerModalUI(),registerTabsUI(),registerDarkTheme(),registerDefaultTheme(),registerLightTheme(),registerFormControlsInterfaces(),registerComponentsInterfaces(),registerHelpersInterfaces(),registerActiveTriggerExtension(),registerThrottleEventExtension(),registerPopoverExtension(),registerNumberFilterExtension(),registerDragExtension(),registerSortableExtension(),registerTabExtension(),registerLoadMoreExtension(),registerDropdownExtension()})();
//# sourceMappingURL=ui-builder.min.js.map
